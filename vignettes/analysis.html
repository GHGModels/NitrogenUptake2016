<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Troy D. Hill, Nathalie R. Sommer, Caroline R. Kanaskie, Emily A. Santos, and Autumn J. Oczkowski" />

<meta name="date" content="2018-05-10" />

<title>Source code from nitrogen uptake manuscript (Hill et al. in press)</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Source code from nitrogen uptake manuscript (Hill et al. in press)</h1>
<h4 class="author"><em>Troy D. Hill, Nathalie R. Sommer, Caroline R. Kanaskie, Emily A. Santos, and Autumn J. Oczkowski</em></h4>
<h4 class="date"><em>2018-05-10</em></h4>



<div id="r-code-and-analysis-associated-with-manuscript-nitrogen-uptake-and-allocation-by-spartina-alterniflora-and-distichlis-spicata" class="section level2">
<h2>R code and analysis associated with manuscript “Nitrogen uptake and allocation by <em>Spartina alterniflora</em> and <em>Distichlis spicata</em>”</h2>
</div>
<div id="allometry-models" class="section level2">
<h2>Allometry models</h2>
<p>Live plants were collected from Colt State Park (Bristol, Rhode Island, USA) in May, June, and July 2016. On each sampling date, three 25 x 25 cm quadrats were collected from monoculture areas of short-form Spartina alterniflora and Distichlis spicata. Stems were cut at the sediment surface, measured to the nearest millimeter, and a representative subsample of stems were individually dried to constant weight at 50oC.</p>
<p>These live stem masses and heights were used to establish allometric relationships and non-destructively estimate plant masses. Species-specific allometry models were parameterized using Box-Cox power transformations of biomass (lambda) and untransformed plant heights.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Allometry ----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">##### Establish relationships following Lu et al. 2016</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">CSP &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">dlply</span>(allometry, <span class="kw">c</span>(<span class="st">&quot;spp&quot;</span>), bCM)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">CSP.coef &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ldply</span>(CSP, stats<span class="op">::</span>coef)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">CSP.coef<span class="op">$</span>lam &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(allometry, <span class="kw">c</span>(<span class="st">&quot;spp&quot;</span>), <span class="cf">function</span>(df)  <span class="kw">bCM</span>(df, <span class="dt">lam.only =</span> <span class="ot">TRUE</span>))[, <span class="st">&quot;V1&quot;</span>]</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">CSP.coef<span class="op">$</span>BIC &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ldply</span>(CSP, stats<span class="op">::</span>BIC)[, <span class="st">&quot;V1&quot;</span>]</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">CSP.coef<span class="op">$</span>rsq &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ldply</span>(CSP, MuMIn<span class="op">::</span>r.squaredGLMM)[, <span class="st">&quot;R2m&quot;</span>]</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">CSP.coef</a></code></pre></div>
<pre><code>##    spp (Intercept)     height       lam       BIC       rsq
## 1 DISP   0.1183695 0.01006004 0.5000000 -213.1622 0.8351659
## 2 SPAL   0.1368092 0.01850430 0.3333333 -115.1613 0.9601338</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># png(filename = here(&quot;output/Figure1.png&quot;), width = 100, height = 100, units = &quot;mm&quot;, res = 400)</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">fig =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">graphics<span class="op">::</span><span class="kw">plot</span>(sample <span class="op">~</span><span class="st"> </span>height_cm, <span class="dt">data =</span> allometry[(allometry<span class="op">$</span>spp <span class="op">%in%</span><span class="st"> &quot;DISP&quot;</span>), ],</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">     <span class="dt">cex =</span> pointSize <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> fig2Col,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;Total mass (g)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Height (cm)&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.65</span>), <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">     <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">tcl =</span> <span class="fl">0.25</span>, <span class="dt">tck =</span> <span class="fl">0.01</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">graphics<span class="op">::</span><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">graphics<span class="op">::</span><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">graphics<span class="op">::</span><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">tcl =</span> <span class="fl">0.25</span>, <span class="dt">tck =</span> <span class="fl">0.01</span>, <span class="dt">at =</span> <span class="kw">axTicks</span>(<span class="dv">1</span>), <span class="dt">labels =</span> graphics<span class="op">::</span><span class="kw">axTicks</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">graphics<span class="op">::</span><span class="kw">points</span>(sample <span class="op">~</span><span class="st"> </span>height_cm, <span class="dt">data =</span> allometry[(allometry<span class="op">$</span>spp <span class="op">%in%</span><span class="st"> &quot;SPAL&quot;</span>), ],  <span class="dt">cex =</span> pointSize <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">pch =</span> <span class="dv">17</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">x &lt;-<span class="st"> </span>allometry[(allometry<span class="op">$</span>spp <span class="op">%in%</span><span class="st"> &quot;DISP&quot;</span>), <span class="st">&quot;height_cm&quot;</span>]</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">x.spal &lt;-<span class="st"> </span>allometry[(allometry<span class="op">$</span>spp <span class="op">%in%</span><span class="st"> &quot;SPAL&quot;</span>), <span class="st">&quot;height_cm&quot;</span>]</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">y.pred2 &lt;-<span class="st"> </span>(x <span class="op">*</span><span class="st"> </span>CSP.coef[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>CSP.coef[<span class="dv">1</span>, <span class="st">&quot;(Intercept)&quot;</span>])<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>CSP.coef<span class="op">$</span>lam[<span class="dv">1</span>]) <span class="co"># DISP</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">y.pred3 &lt;-<span class="st"> </span>(x.spal <span class="op">*</span><span class="st"> </span>CSP.coef[<span class="dv">2</span>, <span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>CSP.coef[<span class="dv">2</span>, <span class="st">&quot;(Intercept)&quot;</span>])<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>CSP.coef<span class="op">$</span>lam[<span class="dv">2</span>]) <span class="co"># SPAL</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">graphics<span class="op">::</span><span class="kw">lines</span>(<span class="dt">x =</span> x[<span class="kw">order</span>(y.pred2)], <span class="dt">y =</span> y.pred2[<span class="kw">order</span>(y.pred2)], <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> fig2Col)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">graphics<span class="op">::</span><span class="kw">lines</span>(<span class="dt">x =</span> x.spal[<span class="kw">order</span>(y.pred3)], <span class="dt">y =</span> y.pred3[<span class="kw">order</span>(y.pred3)], <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">20</span>, <span class="dt">y =</span> <span class="fl">0.52</span>, <span class="dt">cex =</span> <span class="fl">0.95</span>, <span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;Spartina&quot;</span>)))</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">65</span>, <span class="dt">y =</span> <span class="fl">0.3</span>, <span class="dt">cex =</span> <span class="fl">0.95</span>, <span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;Distichlis&quot;</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The mass of plants growing in the mesocosms were estimated from weekly plant height measurements and the species-specific allometry equations of the form mass = (height*a + b)1/lambda (reported in CSP.coef, above).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">### estimate plant masses from allometry</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(stemHeights)) {</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="cf">if</span> (stemHeights<span class="op">$</span>species[i] <span class="op">%in%</span><span class="st"> &quot;DS&quot;</span>) {</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    stemHeights<span class="op">$</span>mass[i] &lt;-<span class="st"> </span>(stemHeights<span class="op">$</span>height_cm[i] <span class="op">*</span><span class="st"> </span>CSP.coef[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>CSP.coef[<span class="dv">1</span>, <span class="st">&quot;(Intercept)&quot;</span>])<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>CSP.coef<span class="op">$</span>lam[<span class="dv">1</span>]) <span class="co"># DISP</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  } <span class="cf">else</span> <span class="cf">if</span> (stemHeights<span class="op">$</span>species[i] <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>) {</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    stemHeights<span class="op">$</span>mass[i] &lt;-<span class="st"> </span>(stemHeights<span class="op">$</span>height_cm[i] <span class="op">*</span><span class="st"> </span>CSP.coef[<span class="dv">2</span>, <span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>CSP.coef[<span class="dv">2</span>, <span class="st">&quot;(Intercept)&quot;</span>])<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>CSP.coef<span class="op">$</span>lam[<span class="dv">2</span>]) <span class="co"># SPAL</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  }</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">}</a></code></pre></div>
</div>
<div id="allometry-validation-comparison-between-predicted-and-harvested-masses" class="section level2">
<h2>Allometry validation: comparison between predicted and harvested masses</h2>
<p>To evaluate the performance of our allometry models, predicted biomass was compared with aboveground biomass directly measured during mesocosm harvest.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">###</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">### compare predicted (allometry) and observed masses at harvest</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">###</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># get live + dead biomass for each pot at each date</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">dat.ld &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(stemHeights, plyr<span class="op">::</span>.(core_num, species, date), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                <span class="dt">live =</span> <span class="kw">sum</span>(mass[dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">                <span class="dt">dead =</span> <span class="kw">sum</span>(mass[dead_live <span class="op">%in%</span><span class="st"> &quot;D&quot;</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co"># add cohort number</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">dat.ld<span class="op">$</span>day &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="kw">as.character</span>(dat.ld<span class="op">$</span>date), <span class="dt">format =</span> <span class="st">&quot;%y%m%d&quot;</span>, <span class="dt">origin =</span> <span class="st">&quot;1960-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">dat.ld<span class="op">$</span>cohort &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(dat.ld<span class="op">$</span>day))) {</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">  uniqueIDS &lt;-<span class="st"> </span><span class="kw">unique</span>(dat.ld<span class="op">$</span>core_num[dat.ld<span class="op">$</span>day <span class="op">==</span><span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(dat.ld<span class="op">$</span>day))[i]])</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">  <span class="cf">if</span> (<span class="kw">length</span>(uniqueIDS) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">    dat.ld<span class="op">$</span>cohort[dat.ld<span class="op">$</span>core_num <span class="op">%in%</span><span class="st"> </span>uniqueIDS] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">sum</span>(<span class="kw">is.finite</span>(dat.ld<span class="op">$</span>cohort)) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="kw">max</span>(dat.ld<span class="op">$</span>cohort, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">  }</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">dat.ld<span class="op">$</span>cohort[<span class="kw">is.na</span>(dat.ld<span class="op">$</span>cohort)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23">dat.ld<span class="op">$</span>cohort[dat.ld<span class="op">$</span>cohort <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"></a>
<a class="sourceLine" id="cb5-26" data-line-number="26">dat.ld<span class="op">$</span>year &lt;-<span class="st"> </span><span class="dv">2016</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27">dat.ld<span class="op">$</span>dead &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">dat.ld<span class="op">$</span>pot2  &lt;-<span class="st"> </span><span class="kw">paste0</span>(dat.ld<span class="op">$</span>core_num, <span class="st">&quot;-&quot;</span>, dat.ld<span class="op">$</span>species)</a>
<a class="sourceLine" id="cb5-29" data-line-number="29"></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"></a>
<a class="sourceLine" id="cb5-32" data-line-number="32">### allometry estimates</a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(dat.ld<span class="op">$</span>pot2))) {</a>
<a class="sourceLine" id="cb5-34" data-line-number="34">  targPot &lt;-<span class="st"> </span><span class="kw">unique</span>(dat.ld<span class="op">$</span>pot2)[i]</a>
<a class="sourceLine" id="cb5-35" data-line-number="35">  maxDate &lt;-<span class="st"> </span><span class="kw">max</span>(dat.ld<span class="op">$</span>day[dat.ld<span class="op">$</span>pot2 <span class="op">%in%</span><span class="st"> </span>targPot])</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">  tempDat &lt;-<span class="st"> </span>dat.ld[(dat.ld<span class="op">$</span>pot2 <span class="op">%in%</span><span class="st"> </span>targPot) <span class="op">&amp;</span><span class="st"> </span>(dat.ld<span class="op">$</span>day <span class="op">==</span><span class="st"> </span>maxDate), ]</a>
<a class="sourceLine" id="cb5-37" data-line-number="37">  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">    dat.ld.sub  &lt;-<span class="st"> </span>tempDat</a>
<a class="sourceLine" id="cb5-39" data-line-number="39">  }</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">  <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb5-41" data-line-number="41">    dat.ld.sub &lt;-<span class="st"> </span><span class="kw">rbind</span>(dat.ld.sub, tempDat)</a>
<a class="sourceLine" id="cb5-42" data-line-number="42">  }</a>
<a class="sourceLine" id="cb5-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb5-44" data-line-number="44">dat.ld.sub<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">paste0</span>(dat.ld.sub<span class="op">$</span>species, <span class="st">&quot;-&quot;</span>, dat.ld.sub<span class="op">$</span>core_num)</a>
<a class="sourceLine" id="cb5-45" data-line-number="45"></a>
<a class="sourceLine" id="cb5-46" data-line-number="46">### observed values</a>
<a class="sourceLine" id="cb5-47" data-line-number="47">obs &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;leaf 1&quot;</span>, <span class="st">&quot;leaf 2&quot;</span>, <span class="st">&quot;leaf 3&quot;</span>, <span class="st">&quot;leaf 4&quot;</span>, <span class="co"># &quot;dead leaf&quot;,</span></a>
<a class="sourceLine" id="cb5-48" data-line-number="48">                                            <span class="st">&quot;leaf 5&quot;</span>, <span class="st">&quot;leaf 6&quot;</span>, <span class="st">&quot;leaf 7&quot;</span>, <span class="st">&quot;leaf 8&quot;</span>, <span class="st">&quot;leaf 9&quot;</span>, <span class="st">&quot;leaf 10&quot;</span>, <span class="st">&quot;leaf 11&quot;</span>,</a>
<a class="sourceLine" id="cb5-49" data-line-number="49">                                            <span class="st">&quot;stems&quot;</span>), ], plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb5-50" data-line-number="50">             <span class="dt">g        =</span> <span class="kw">sum</span>(g_core, <span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb5-51" data-line-number="51">)</a>
<a class="sourceLine" id="cb5-52" data-line-number="52">obs<span class="op">$</span>core_num &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.integer</span>(<span class="kw">substr</span>(obs<span class="op">$</span>new.core.id, <span class="dv">3</span>, <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb5-53" data-line-number="53">obs<span class="op">$</span>core_num[<span class="kw">as.integer</span>(obs<span class="op">$</span>core_num) <span class="op">&gt;</span><span class="st"> </span><span class="dv">12</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(obs<span class="op">$</span>species[<span class="kw">as.integer</span>(obs<span class="op">$</span>core_num) <span class="op">&gt;</span><span class="st"> </span><span class="dv">12</span>], <span class="kw">as.integer</span>(obs<span class="op">$</span>core_num[<span class="kw">as.integer</span>(obs<span class="op">$</span>core_num) <span class="op">&gt;</span><span class="st"> </span><span class="dv">12</span>]) <span class="op">-</span><span class="st"> </span><span class="dv">12</span>, <span class="st">&quot;_T0&quot;</span>)</a>
<a class="sourceLine" id="cb5-54" data-line-number="54">obs<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">paste0</span>(obs<span class="op">$</span>species, <span class="st">&quot;-&quot;</span>, obs<span class="op">$</span>core_num)</a>
<a class="sourceLine" id="cb5-55" data-line-number="55"></a>
<a class="sourceLine" id="cb5-56" data-line-number="56">obs &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join_all</span>(<span class="kw">list</span>(obs, dat.ld.sub[, <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">9</span><span class="op">:</span><span class="dv">10</span>)]), <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</a>
<a class="sourceLine" id="cb5-57" data-line-number="57"><span class="kw">names</span>(obs)[<span class="kw">which</span>(<span class="kw">names</span>(obs) <span class="op">%in%</span><span class="st"> &quot;live&quot;</span>)] &lt;-<span class="st"> &quot;allom.est&quot;</span></a>
<a class="sourceLine" id="cb5-58" data-line-number="58">obs<span class="op">$</span>diff &lt;-<span class="st"> </span>(obs<span class="op">$</span>allom.est <span class="op">-</span><span class="st"> </span>obs<span class="op">$</span>g)             <span class="co"># magnitude accuracy of allometry prediction (g)</span></a>
<a class="sourceLine" id="cb5-59" data-line-number="59">obs<span class="op">$</span>diff.pct &lt;-<span class="st"> </span>(obs<span class="op">$</span>allom.est <span class="op">-</span><span class="st"> </span>obs<span class="op">$</span>g) <span class="op">/</span><span class="st"> </span>obs<span class="op">$</span>g <span class="co"># percent accuracy of allometry prediction</span></a>
<a class="sourceLine" id="cb5-60" data-line-number="60">obs<span class="op">$</span>species2 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(obs<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="st">&quot;italic(S.~alterniflora)&quot;</span>, <span class="st">&quot;italic(D.~spicata)&quot;</span>)</a>
<a class="sourceLine" id="cb5-61" data-line-number="61"><span class="kw">summary</span>(obs<span class="op">$</span>diff)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -0.4460  0.1211  0.4043  0.4083  0.7259  1.1485</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Figure S1 - predicted vs obs biomass ---------------------------------------</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">ggplot</span>(obs, <span class="kw">aes</span>(<span class="dt">x =</span> allom.est <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">y =</span> g <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">colour =</span> species2, <span class="dt">shape =</span> species2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">%+replace%</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="st">&quot;Predicted biomass (allometry; g&quot;</span><span class="op">%.%</span>m<span class="op">^-</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;)&quot;</span>), <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Measured biomass (g &quot;</span><span class="op">%.%</span>m<span class="op">^-</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">650</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">650</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(obs<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(obs<span class="op">$</span>species2)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(obs<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(obs<span class="op">$</span>species2)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.9</span>), <span class="dt">legend.text.align =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/FigureS1_&quot;, todaysDate, &quot;.png&quot;), width = 90, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
</div>
<div id="relative-growth-rates" class="section level2">
<h2>Relative growth rates</h2>
<p>All live plants in each of the 24 mesocosms were tagged and measured to the nearest millimeter on 22 June, 29 June, 6 July, 13 July, and 20 July 2016. Stem heights were also recorded for mesocosms as they were harvested. New plants were tagged throughout the experiment, and in total 839 unique plants were tracked. Relative growth rates were calculated for each tagged plant as the difference between sequential log-transformed plant masses, as described in equation 1 of Hill et al. (in press).</p>
<p>Relative growth rates were averaged across all unique stems in each mesocosm. When multiple growth rate measurements were available for an individual plant, they were averaged to get a single representative quantity for each unique plant, before calculating a mesocosm average.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Relative growth rates ---------------------------------------------------</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">stemHeights<span class="op">$</span>RGR &lt;-<span class="st"> </span>stemHeights<span class="op">$</span>lateStartDate &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(stemHeights<span class="op">$</span>id[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>]))) { <span class="co"># 830 plants</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  targPlant &lt;-<span class="st"> </span><span class="kw">unique</span>(stemHeights<span class="op">$</span>id[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>])[i]</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  subDat &lt;-<span class="st"> </span>stemHeights[stemHeights<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span>targPlant, ]</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">  <span class="cf">if</span> (<span class="kw">nrow</span>(subDat) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    subDat<span class="op">$</span>mass2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, subDat<span class="op">$</span>mass[<span class="dv">1</span><span class="op">:</span>(<span class="kw">nrow</span>(subDat)<span class="op">-</span><span class="dv">1</span>)])</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    subDat<span class="op">$</span>day2 &lt;-<span class="st"> </span><span class="kw">c</span>(subDat<span class="op">$</span>day[<span class="dv">1</span>], subDat<span class="op">$</span>day[<span class="dv">1</span><span class="op">:</span>(<span class="kw">nrow</span>(subDat)<span class="op">-</span><span class="dv">1</span>)])</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    subDat<span class="op">$</span>RGR &lt;-<span class="st"> </span>(<span class="kw">log</span>(subDat<span class="op">$</span>mass) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(subDat<span class="op">$</span>mass2)) <span class="op">/</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">difftime</span>(subDat<span class="op">$</span>day, subDat<span class="op">$</span>day2, <span class="dt">units =</span> <span class="st">&quot;days&quot;</span>))</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">    ### add RGRs to dat.live object</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    stemHeights<span class="op">$</span>RGR[(<span class="kw">which</span>(<span class="kw">rownames</span>(stemHeights) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(subDat)))] &lt;-<span class="st"> </span>subDat<span class="op">$</span>RGR</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>(subDat<span class="op">$</span>height[<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span>(subDat<span class="op">$</span>height[<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span>)) {</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">      stemHeights<span class="op">$</span>lateStartDate[<span class="kw">which</span>(<span class="kw">rownames</span>(stemHeights) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(subDat))] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># indicates if high-growth period is captured</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"></a>
<a class="sourceLine" id="cb9-19" data-line-number="19">stemHeights<span class="op">$</span>RGR[<span class="op">!</span><span class="kw">is.finite</span>(stemHeights<span class="op">$</span>RGR)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co"># mean growth rate for each plant, then each mesocosm</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22">mean.rgr     &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(stemHeights[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>, ], plyr<span class="op">::</span>.(id, new.core.id, species), plyr<span class="op">::</span>summarise, <span class="dt">meanRGR =</span> <span class="kw">mean</span>(RGR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">mean.rgr.pot &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(mean.rgr, plyr<span class="op">::</span>.(new.core.id, species), plyr<span class="op">::</span>summarise, <span class="dt">RGR =</span> <span class="kw">mean</span>(meanRGR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb9-24" data-line-number="24">mean.rgr.pot &lt;-<span class="st"> </span>mean.rgr.pot[<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, ]</a></code></pre></div>
</div>
<div id="stem-density-and-primary-production" class="section level2">
<h2>Stem density and primary production</h2>
<p>Our dataset also allowed calculation of stem densities and primary production. Primary production was calculated for each mesocosm as the sum of positive live biomass increments at the mesocosm-scale (Milner and Hughes, 1968).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Stem density and biomass ------------------------------------------------</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">### summarize by pot and session</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">dat.live &lt;-<span class="st"> </span>stemHeights[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>, ]</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">ddHgt2 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(dat.live, plyr<span class="op">::</span>.(date, day, core_num, species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">ddHgt2<span class="op">$</span>day &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(ddHgt2<span class="op">$</span>day, <span class="dt">origin =</span> <span class="st">&quot;1960-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">ddHgt2<span class="op">$</span>cohort &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(ddHgt2<span class="op">$</span>date))) {</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">  uniqueIDS &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt2<span class="op">$</span>core_num[ddHgt2<span class="op">$</span>date <span class="op">==</span><span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(ddHgt2<span class="op">$</span>date))[i]])</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">  <span class="cf">if</span> (<span class="kw">length</span>(uniqueIDS) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">    ddHgt2<span class="op">$</span>cohort[ddHgt2<span class="op">$</span>core_num <span class="op">%in%</span><span class="st"> </span>uniqueIDS] &lt;-<span class="st"> </span>i</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">ddHgt2<span class="op">$</span>cohort &lt;-<span class="st"> </span>(ddHgt2<span class="op">$</span>cohort <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16">ddHgt2<span class="op">$</span>cohort[<span class="kw">is.na</span>(ddHgt2<span class="op">$</span>cohort)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"></a>
<a class="sourceLine" id="cb10-19" data-line-number="19">ddHgt4 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(ddHgt2, plyr<span class="op">::</span>.(day, cohort, species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">ddHgt4.se &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(ddHgt2, plyr<span class="op">::</span>.(day, cohort, species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="kw">names</span>(ddHgt4.se) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(ddHgt4.se), <span class="st">&quot;.se&quot;</span>)</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">ddHgt4 &lt;-<span class="st"> </span><span class="kw">cbind</span>(ddHgt4, ddHgt4.se[, <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)])</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">ddHgt4<span class="op">$</span>session &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(ddHgt4<span class="op">$</span>day, <span class="dt">origin =</span> <span class="st">&quot;1960-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">ddHgt4<span class="op">$</span>species2 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ddHgt4<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="st">&quot;italic(S.~alterniflora)&quot;</span>, <span class="st">&quot;italic(D.~spicata)&quot;</span>)</a>
<a class="sourceLine" id="cb10-25" data-line-number="25"></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"></a>
<a class="sourceLine" id="cb10-28" data-line-number="28">####</a>
<a class="sourceLine" id="cb10-29" data-line-number="29">#### Calculate Milner-Hughes NAPP</a>
<a class="sourceLine" id="cb10-30" data-line-number="30">####</a>
<a class="sourceLine" id="cb10-31" data-line-number="31">test &lt;-<span class="st"> </span><span class="kw">nappCalc2</span>(<span class="dt">dataset =</span> dat.ld[dat.ld<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, ], <span class="dt">liveCol =</span> <span class="st">&quot;live&quot;</span>, <span class="dt">siteCol =</span> <span class="st">&quot;pot2&quot;</span>, <span class="dt">timeCol =</span> <span class="st">&quot;day&quot;</span>, <span class="dt">summarize =</span> <span class="st">&quot;TRUE&quot;</span>, <span class="dt">annualReset =</span> <span class="st">&quot;FALSE&quot;</span>)</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">napp &lt;-<span class="st"> </span>test<span class="op">$</span>summary</a>
<a class="sourceLine" id="cb10-33" data-line-number="33">napp<span class="op">$</span>pot2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(napp<span class="op">$</span>site)</a>
<a class="sourceLine" id="cb10-34" data-line-number="34">napp<span class="op">$</span>core_num &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">sapply</span>(<span class="kw">strsplit</span>(napp<span class="op">$</span>pot2, <span class="st">&quot;-&quot;</span>),  <span class="st">&quot;[[&quot;</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-35" data-line-number="35">napp<span class="op">$</span>species  &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(napp<span class="op">$</span>pot2, <span class="st">&quot;-&quot;</span>),  <span class="st">&quot;[[&quot;</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-36" data-line-number="36"></a>
<a class="sourceLine" id="cb10-37" data-line-number="37">napp<span class="op">$</span>cohort &lt;-<span class="st"> </span>dat.ld<span class="op">$</span>cohort[<span class="kw">match</span>(napp<span class="op">$</span>pot2, dat.ld<span class="op">$</span>pot2)]</a>
<a class="sourceLine" id="cb10-38" data-line-number="38">napp<span class="op">$</span>new.core.id &lt;-<span class="st"> </span><span class="kw">ifelse</span>(napp<span class="op">$</span>core_num <span class="op">&gt;</span><span class="st"> </span><span class="dv">9</span>, <span class="kw">paste0</span>(napp<span class="op">$</span>species, napp<span class="op">$</span>core_num), <span class="kw">paste0</span>(napp<span class="op">$</span>species, <span class="st">&quot;0&quot;</span>, napp<span class="op">$</span>core_num))</a>
<a class="sourceLine" id="cb10-39" data-line-number="39"></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"></a>
<a class="sourceLine" id="cb10-41" data-line-number="41">### build object to merge with master: average RGR, stem characteristics</a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co"># mean growth rate for each plant, then each mesocosm</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43">mean.rgr     &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(stemHeights[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>, ], plyr<span class="op">::</span>.(id, new.core.id, species), plyr<span class="op">::</span>summarise, <span class="dt">meanRGR =</span> <span class="kw">mean</span>(RGR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-44" data-line-number="44">mean.rgr.pot &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(mean.rgr, plyr<span class="op">::</span>.(new.core.id, species), plyr<span class="op">::</span>summarise, <span class="dt">rgr =</span> <span class="kw">mean</span>(meanRGR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-45" data-line-number="45">mean.rgr.pot &lt;-<span class="st"> </span>mean.rgr.pot[<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, ]</a>
<a class="sourceLine" id="cb10-46" data-line-number="46"></a>
<a class="sourceLine" id="cb10-47" data-line-number="47">mean.dens     &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(stemHeights[stemHeights<span class="op">$</span>dead_live <span class="op">%in%</span><span class="st"> &quot;L&quot;</span>, ], plyr<span class="op">::</span>.(new.core.id, date), plyr<span class="op">::</span>summarise, <span class="dt">stem.density =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(height_cm)))</a>
<a class="sourceLine" id="cb10-48" data-line-number="48">mean.dens.pot &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(mean.dens, plyr<span class="op">::</span>.(new.core.id), plyr<span class="op">::</span>summarise, <span class="dt">dens =</span> <span class="kw">mean</span>(stem.density <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># mean of all stem density msrmts for a pot</span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49">mean.dens.pot &lt;-<span class="st"> </span>mean.dens.pot[<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>, ]</a>
<a class="sourceLine" id="cb10-50" data-line-number="50"></a>
<a class="sourceLine" id="cb10-51" data-line-number="51">rgr.stems &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join_all</span>(<span class="kw">list</span>(mean.rgr.pot, mean.dens.pot), <span class="dt">by =</span> <span class="st">&quot;new.core.id&quot;</span>)</a></code></pre></div>
</div>
<div id="denitrification-enzyme-activity-potential-and-in-vitro-denitrifcation" class="section level2">
<h2>Denitrification enzyme activity: potential and in vitro denitrifcation</h2>
<p>These data are derived from two sets of acetylene inhibition assays conducted using bulk sediment from the 0-5 cm depth intervals of each of the six mesocosms harvested on 9 July 2016. The two assays measured denitrification enzyme activity (DEA) potential and “in vitro” or ambient denitrification. DEA potential was measured by incubating 6.5 g of sediment in 70 mL jars sealed with rubber septa. Sample containers were amended with 12 mL of nutrient-amended filtered seawater (7 mmol N L-1 as KNO3; 17 mmol C L-1 as D-glucose; and 6 mmol P L-1 as KH2PO4) with 0.125 g L-1 chloramphenicol added as a microbial inhibitor. Containers were alternately evacuated and flushed with N2 three times, and acetylene (10% of headspace volume) was added to block reduction of N2O to N2.</p>
<p>In vitro denitrification was measured in nearly identical acetylene inhibition assays. The only difference was the use of 12 mL of unamended filtered seawater rather than a nutrient solution, following Warneke et al. (2011). The potential and in vitro DEA data provided here reflect the slope of the line of best fit for dilution-corrected N2O concentrations in the jar headspace. At least three points were used for each rate estimate, and all relationships had r2 ??? 0.92 (mean r2 = 0.97). A laboratory blank using DEA solution and no added sediment yielded zero flux (slope = 0.0; r2 = 0.0), so no blank correction was applied. Rates are provided on a per-gram basis (units: nmol N2O per g dry mass per hr).</p>
<p>Differences between species and assay types were tested using two-way ANOVA.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Denitrification enzyme activity -----------------------------------------</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">dea<span class="op">$</span>species  &lt;-<span class="st"> </span><span class="kw">substr</span>(dea<span class="op">$</span>pot, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">dea<span class="op">$</span>species2 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(dea<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="st">&quot;italic(S.~alterniflora)&quot;</span>, <span class="st">&quot;italic(D.~spicata)&quot;</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">dea<span class="op">$</span>DEA.m2   &lt;-<span class="st"> </span>dea<span class="op">$</span>DEA <span class="op">*</span><span class="st"> </span>dea<span class="op">$</span>bd_gcm3 <span class="op">*</span><span class="st"> </span>(top.vol <span class="op">/</span><span class="st"> </span>core.area) <span class="co"># * 5 * 1e4 # [flux per gram] * [g/cm3] * [5 cm depth] * [cm2/m2]</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">dea<span class="op">$</span>IV.m2    &lt;-<span class="st"> </span>dea<span class="op">$</span>IV <span class="op">*</span><span class="st"> </span>dea<span class="op">$</span>bd_gcm3  <span class="op">*</span><span class="st"> </span>(top.vol <span class="op">/</span><span class="st"> </span>core.area) <span class="co"># * 5 * 1e4</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">dea<span class="op">$</span>gap.g    &lt;-<span class="st"> </span>dea<span class="op">$</span>DEA <span class="op">-</span><span class="st"> </span>dea<span class="op">$</span>IV</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">dea<span class="op">$</span>gap.m2   &lt;-<span class="st"> </span>dea<span class="op">$</span>DEA.m2 <span class="op">-</span><span class="st"> </span>dea<span class="op">$</span>IV.m2</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">dd.dea &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(dea, plyr<span class="op">::</span>.(species, species2), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">                <span class="dt">flux.g =</span> <span class="kw">mean</span>(DEA),</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">                <span class="dt">flux.m2 =</span> <span class="kw">mean</span>(DEA.m2),</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">                <span class="dt">flux.g.se =</span> <span class="kw">se</span>(DEA),</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">                <span class="dt">flux.m2.se =</span> <span class="kw">se</span>(DEA.m2)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">dd.dea<span class="op">$</span>type &lt;-<span class="st"> &quot;DEA&quot;</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">dd.iv &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(dea, plyr<span class="op">::</span>.(species, species2), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">               <span class="dt">flux.g =</span> <span class="kw">mean</span>(IV),</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">               <span class="dt">flux.m2 =</span> <span class="kw">mean</span>(IV.m2),</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">               <span class="dt">flux.g.se =</span> <span class="kw">se</span>(IV),</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">               <span class="dt">flux.m2.se =</span> <span class="kw">se</span>(IV.m2)</a>
<a class="sourceLine" id="cb11-23" data-line-number="23">)</a>
<a class="sourceLine" id="cb11-24" data-line-number="24">dd.iv<span class="op">$</span>type &lt;-<span class="st"> &quot;GHG&quot;</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"></a>
<a class="sourceLine" id="cb11-26" data-line-number="26">dd.dea &lt;-<span class="st"> </span><span class="kw">rbind</span>(dd.dea, dd.iv)</a>
<a class="sourceLine" id="cb11-27" data-line-number="27"></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"></a>
<a class="sourceLine" id="cb11-29" data-line-number="29">### stats on DEA/IV N2O flux</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">dea.m     &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(dea, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;species&quot;</span>, <span class="st">&quot;species2&quot;</span>, <span class="st">&quot;pot&quot;</span>), <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">8</span><span class="op">:</span><span class="dv">11</span>))</a>
<a class="sourceLine" id="cb11-31" data-line-number="31">dea.m<span class="op">$</span>ID  &lt;-<span class="st"> </span><span class="kw">paste0</span>(dea.m<span class="op">$</span>species, <span class="st">&quot;-&quot;</span>, dea.m<span class="op">$</span>variable)</a>
<a class="sourceLine" id="cb11-32" data-line-number="32"></a>
<a class="sourceLine" id="cb11-33" data-line-number="33">dea.g.aov &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(variable) <span class="op">*</span><span class="st"> </span><span class="kw">factor</span>(species), <span class="dt">data =</span> dea.m[(dea.m<span class="op">$</span>variable <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;IV.m2&quot;</span>, <span class="st">&quot;DEA.m2&quot;</span>)), ])</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">car<span class="op">::</span><span class="kw">Anova</span>(dea.g.aov, <span class="dt">type =</span> <span class="dv">3</span>, <span class="dt">singular =</span> <span class="ot">TRUE</span>) <span class="co"># no difference between species or method</span></a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: value
##                                      Sum Sq Df F value   Pr(&gt;F)   
## (Intercept)                      6.5538e+10  1 18.4663 0.002626 **
## factor(variable)                 1.1945e+10  1  3.3657 0.103906   
## factor(species)                  3.8267e+09  1  1.0782 0.329460   
## factor(variable):factor(species) 1.9879e+07  1  0.0056 0.942179   
## Residuals                        2.8393e+10  8                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="n-tracer-data-preparation-background-correction" class="section level2">
<h2>15N tracer: data preparation, background correction</h2>
<p>After collection of marsh cores, six were harvested to capture background isotope ratios in each pool. The remaining 24 mesocosms were grown in a greenhouse receiving raw Narragansett Bay seawater under a simulated semi-diurnal tidal regime.</p>
<p>During an ebb tide on 24 June 2016, 1.95 mg 15N was added to each mesocosm by injecting a solution of 99 atom percent 15N as KNO3 in artificial seawater.</p>
<p>At each subsequent week, three mesocosms of each vegetation type were harvested and separated into a wide range of vegetative and bulk sediment pools, with 15N recovery indicating N uptake and allocation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># how much 15N was added to each pot?</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">KNO3    &lt;-<span class="st"> </span><span class="fl">2.24047</span>           <span class="co"># grams of KNO3 added</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">soln    &lt;-<span class="st"> </span><span class="fl">2027.5</span>            <span class="co"># final volume of spike solution (mls)</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">KNO3_mw &lt;-<span class="st"> </span><span class="fl">102.1032</span>       <span class="co"># g/mol</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">N_mw    &lt;-<span class="st"> </span><span class="dv">15</span>                <span class="co"># gN/mol KNO3</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">mls     &lt;-<span class="st"> </span><span class="dv">12</span>                <span class="co"># mls added per mesocosm</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">spike   &lt;-<span class="st"> </span>KNO3 <span class="op">*</span><span class="st"> </span>(N_mw <span class="op">/</span><span class="st"> </span>KNO3_mw) <span class="op">/</span><span class="st"> </span>soln <span class="op">*</span><span class="st"> </span>mls <span class="co"># total grams of 15N added to each mesocosm</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co"># calculate atom pct from per mil values</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">CN_mass_data<span class="op">$</span>n_ap &lt;-<span class="st"> </span><span class="kw">ap</span>(CN_mass_data<span class="op">$</span>d15n)</a></code></pre></div>
<p>Background 15N isotope ratios were based on the time-zero mesocosms, which received no tracer.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># get background 15N AP</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">bkd &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[<span class="kw">as.character</span>(CN_mass_data<span class="op">$</span>time) <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>, ], plyr<span class="op">::</span>.(species, pool_label), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">             <span class="dt">n15 =</span> <span class="kw">mean</span>(n_ap, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">             <span class="dt">se.n15 =</span> <span class="kw">se</span>(n_ap)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">)</a></code></pre></div>
<p>Background 15N was subtracted from each sample to calculate 15N enrichment in excess of background levels; how much of the added tracer was recovered. We also corrected belowground tissues for sorption by subtracting the 15N enrichment of dead belowground biomass.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># subtract background to get 15N excess (if result is negative, 15Nxs = 0)</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">CN_mass_data<span class="op">$</span>n15xs &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(CN_mass_data)) {</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(CN_mass_data<span class="op">$</span>species[i])) {</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    spp  &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>species[i]</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    pool &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>pool_label[i]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">    a &lt;-<span class="st"> </span>bkd[(bkd<span class="op">$</span>species <span class="op">%in%</span><span class="st"> </span>spp) <span class="op">&amp;</span><span class="st"> </span>(bkd<span class="op">$</span>pool_label <span class="op">%in%</span><span class="st"> </span>pool), <span class="st">&quot;n15&quot;</span>]</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    <span class="cf">if</span>((<span class="kw">is.numeric</span>(a) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">length</span>(a) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))) { <span class="co"># excludes all pools we don't have bkd for</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">      difference &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n_ap[i] <span class="op">-</span><span class="st"> </span>a <span class="co"># NOT decimal fraction</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12">      <span class="kw">ifelse</span> (<span class="op">!</span><span class="kw">is.na</span>(difference) <span class="op">&amp;</span><span class="st"> </span>(difference <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), CN_mass_data<span class="op">$</span>n15xs[i] &lt;-<span class="st"> </span>difference, CN_mass_data<span class="op">$</span>n15xs[i] &lt;-<span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">      difference &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n_ap[i] <span class="op">-</span><span class="st"> </span><span class="fl">0.370317701</span> <span class="co"># assume bkgd of 11 d15N</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15">      <span class="kw">ifelse</span> ((difference <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(difference), CN_mass_data<span class="op">$</span>n15xs[i] &lt;-<span class="st"> </span>difference, CN_mass_data<span class="op">$</span>n15xs[i] &lt;-<span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">    }</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb15-19" data-line-number="19"></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"></a>
<a class="sourceLine" id="cb15-21" data-line-number="21">### Additional correction to belowground live biomass, subtracting 15Nxs of dead MOM to account for sorption</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">CN_mass_data<span class="op">$</span>n15xs_MOM &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15xs <span class="co"># n15xs still useful for total recoveries</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(CN_mass_data)) {</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">  <span class="cf">if</span> (CN_mass_data<span class="op">$</span>time[i] <span class="op">%in%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;t&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)) {</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">    <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(CN_mass_data<span class="op">$</span>depth_top[i])) {</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">      spp    &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>species[i]</a>
<a class="sourceLine" id="cb15-27" data-line-number="27">      coreID &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>new.core.id[i]</a>
<a class="sourceLine" id="cb15-28" data-line-number="28">      pool   &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>pool_label[i]</a>
<a class="sourceLine" id="cb15-29" data-line-number="29">      depth_bottom &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>depth_bottom[i]</a>
<a class="sourceLine" id="cb15-30" data-line-number="30"></a>
<a class="sourceLine" id="cb15-31" data-line-number="31">      a &lt;-<span class="st"> </span>CN_mass_data[(CN_mass_data<span class="op">$</span>new.core.id <span class="op">%in%</span><span class="st"> </span>coreID) <span class="op">&amp;</span><span class="st"> </span>(CN_mass_data<span class="op">$</span>pool_label <span class="op">%in%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;dead biomass &quot;</span>, depth_bottom, <span class="st">&quot;cm&quot;</span>)) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="st">                   </span>(CN_mass_data<span class="op">$</span>depth_bottom <span class="op">==</span><span class="st"> </span>depth_bottom), <span class="st">&quot;n15xs&quot;</span>]</a>
<a class="sourceLine" id="cb15-33" data-line-number="33"></a>
<a class="sourceLine" id="cb15-34" data-line-number="34">      <span class="cf">if</span>((<span class="kw">is.numeric</span>(a) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">length</span>(a) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))) { <span class="co"># excludes all pools we don't have bkd for</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35">        difference &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15xs[i] <span class="op">-</span><span class="st"> </span>a <span class="co"># NOT decimal fraction</span></a>
<a class="sourceLine" id="cb15-36" data-line-number="36">        <span class="kw">ifelse</span> (<span class="op">!</span><span class="kw">is.na</span>(difference) <span class="op">&amp;</span><span class="st"> </span>(difference <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), CN_mass_data<span class="op">$</span>n15xs_MOM[i] &lt;-<span class="st"> </span>difference, CN_mass_data<span class="op">$</span>n15xs_MOM[i] &lt;-<span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-37" data-line-number="37">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb15-38" data-line-number="38">        difference &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n_ap[i] <span class="op">-</span><span class="st"> </span><span class="fl">0.370317701</span> <span class="co"># assume bkgd of 11 d15N</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39">        <span class="kw">ifelse</span> ((difference <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(difference), CN_mass_data<span class="op">$</span>n15xs_MOM[i] &lt;-<span class="st"> </span>difference, CN_mass_data<span class="op">$</span>n15xs_MOM[i] &lt;-<span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-40" data-line-number="40">      }</a>
<a class="sourceLine" id="cb15-41" data-line-number="41">    }</a>
<a class="sourceLine" id="cb15-42" data-line-number="42">  }</a>
<a class="sourceLine" id="cb15-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb15-44" data-line-number="44"></a>
<a class="sourceLine" id="cb15-45" data-line-number="45"></a>
<a class="sourceLine" id="cb15-46" data-line-number="46"></a>
<a class="sourceLine" id="cb15-47" data-line-number="47">CN_mass_data<span class="op">$</span>n15_g_pg_recov  &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15xs  <span class="op">/</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>CN_mass_data<span class="op">$</span>n_pct  <span class="co"># for total recovery</span></a>
<a class="sourceLine" id="cb15-48" data-line-number="48">CN_mass_data<span class="op">$</span>n15_g_recov     &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15_g_pg_recov  <span class="op">*</span><span class="st"> </span>CN_mass_data<span class="op">$</span>g_core  <span class="co"># for total recovery</span></a>
<a class="sourceLine" id="cb15-49" data-line-number="49"></a>
<a class="sourceLine" id="cb15-50" data-line-number="50">CN_mass_data<span class="op">$</span>n15_g_pg &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15xs_MOM <span class="op">/</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>CN_mass_data<span class="op">$</span>n_pct</a>
<a class="sourceLine" id="cb15-51" data-line-number="51">CN_mass_data<span class="op">$</span>n15_g    &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n15_g_pg  <span class="op">*</span><span class="st"> </span>CN_mass_data<span class="op">$</span>g_core</a>
<a class="sourceLine" id="cb15-52" data-line-number="52">CN_mass_data<span class="op">$</span>n_core   &lt;-<span class="st"> </span>CN_mass_data<span class="op">$</span>n_pct <span class="op">*</span><span class="st"> </span>CN_mass_data<span class="op">$</span>g_core</a>
<a class="sourceLine" id="cb15-53" data-line-number="53"></a>
<a class="sourceLine" id="cb15-54" data-line-number="54"><span class="co"># Q: how much sorption is there? (look just at belowground data from t1-4)</span></a>
<a class="sourceLine" id="cb15-55" data-line-number="55"><span class="kw">summary</span>(CN_mass_data<span class="op">$</span>n15xs[<span class="op">!</span><span class="kw">is.na</span>(CN_mass_data<span class="op">$</span>depth_bottom) <span class="op">&amp;</span><span class="st"> </span>(CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;t&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))])</a></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000000 0.004144 0.052932 0.306242 0.443161 3.917218</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">summary</span>(CN_mass_data<span class="op">$</span>n15xs_MOM[<span class="op">!</span><span class="kw">is.na</span>(CN_mass_data<span class="op">$</span>depth_bottom) <span class="op">&amp;</span><span class="st"> </span>(CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;t&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))])</a></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000000 0.000000 0.003806 0.255540 0.362428 3.821532</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Q: does sorption vary by species?  No.</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">summary</span>(CN_mass_data<span class="op">$</span>n15xs[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;dead biomass&quot;</span>])</a></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0005802 0.0045992 0.0426551 0.0408803 0.3853582</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">aov</span>(n15xs <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> CN_mass_data[(CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;dead biomass&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="op">!</span>CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>), ]))</a></code></pre></div>
<pre><code>##              Df Sum Sq  Mean Sq F value Pr(&gt;F)
## species       1 0.0024 0.002427    0.35  0.555
## Residuals   142 0.9850 0.006936</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">aov</span>(n15xs <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> CN_mass_data[(CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;dead biomass&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="op">!</span>CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(CN_mass_data<span class="op">$</span>depth_bottom <span class="op">&lt;</span><span class="st"> </span><span class="dv">11</span>), ])) <span class="co"># doesn't change if focused only on top 10 cm</span></a></code></pre></div>
<pre><code>##             Df Sum Sq  Mean Sq F value Pr(&gt;F)
## species      1 0.0054 0.005367   0.603   0.44
## Residuals   70 0.6226 0.008895</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">### does sorption change over time? No</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(n15xs <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(time, <span class="dv">2</span>, <span class="dv">2</span>)), <span class="dt">data =</span> CN_mass_data[(CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;dead biomass&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="op">!</span>CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>), ])) <span class="co"># no</span></a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = n15xs ~ species + as.numeric(substr(time, 
##     2, 2)), data = CN_mass_data[(CN_mass_data$sample.type %in% 
##     &quot;dead biomass&quot;) &amp; (!CN_mass_data$time %in% &quot;t0&quot;), ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.05864 -0.04911 -0.04135  0.01464  0.32924 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                     0.0552768  0.0184264   3.000  0.00319 **
## speciesSA                      -0.0082109  0.0139290  -0.589  0.55648   
## as.numeric(substr(time, 2, 2))  0.0008402  0.0062293   0.135  0.89289   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.08357 on 141 degrees of freedom
## Multiple R-squared:  0.002587,   Adjusted R-squared:  -0.01156 
## F-statistic: 0.1828 on 2 and 141 DF,  p-value: 0.8331</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(n15xs <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(time, <span class="dv">2</span>, <span class="dv">2</span>)), <span class="dt">data =</span> CN_mass_data[(CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;dead biomass&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="op">!</span>CN_mass_data<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>), ]))</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = n15xs ~ as.numeric(substr(time, 2, 2)), data = CN_mass_data[(CN_mass_data$sample.type %in% 
##     &quot;dead biomass&quot;) &amp; (!CN_mass_data$time %in% &quot;t0&quot;), ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.05453 -0.05088 -0.04153  0.01696  0.33335 
## 
## Coefficients:
##                                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                    0.0511714  0.0170203   3.006  0.00313 **
## as.numeric(substr(time, 2, 2)) 0.0008402  0.0062149   0.135  0.89265   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.08338 on 142 degrees of freedom
## Multiple R-squared:  0.0001287,  Adjusted R-squared:  -0.006913 
## F-statistic: 0.01828 on 1 and 142 DF,  p-value: 0.8926</code></pre>
<p>Two objects contain 15N recoveries - in one version the belowground 15N mass was calculated from the bulk sediment samples (roots + sediment). The second estimates 15N recovery based on organic pools.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># get 15Nxs mass in each pool in each core</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="co"># total recovery using belowground pools (rather than bulk sediment)</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3">mat2 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[<span class="op">!</span>CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;bulk sediment&quot;</span>), ], plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">              <span class="dt">n15_2 =</span> <span class="kw">sum</span>(n15_g_recov, <span class="dt">na.rm  =</span> T)</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">mat2<span class="op">$</span>recovery2 &lt;-<span class="st"> </span>mat2<span class="op">$</span>n15_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(spike) <span class="co"># &quot;recovery&quot; uses bulk belowground data, &quot;recovery2&quot; uses root pools</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="kw">summary</span>(mat2<span class="op">$</span>recovery2[mat2<span class="op">$</span>recovery2 <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>])</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.3373  0.4437  0.5207  0.5447  0.6607  0.8683</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">### relps between napp and 15n recoveries (excludes dead biomass)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">bgd &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>), ],</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">             plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">             <span class="dt">g        =</span> <span class="kw">sum</span>(g_core, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">             <span class="dt">n15    =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">             <span class="dt">n_core   =</span> <span class="kw">sum</span>(n_core, <span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">bgd<span class="op">$</span>g_pg &lt;-<span class="st"> </span>bgd<span class="op">$</span>n15 <span class="op">/</span><span class="st"> </span>bgd<span class="op">$</span>g</a>
<a class="sourceLine" id="cb31-9" data-line-number="9"></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="co"># species-level belowground inventory over time</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12">abv &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;decomp layer&quot;</span>, <span class="st">&quot;leaf 1&quot;</span>, <span class="st">&quot;leaf 2&quot;</span>, <span class="st">&quot;leaf 3&quot;</span>, <span class="st">&quot;leaf 4&quot;</span>,</a>
<a class="sourceLine" id="cb31-13" data-line-number="13">                                            <span class="st">&quot;leaf 5&quot;</span>, <span class="st">&quot;leaf 6&quot;</span>, <span class="st">&quot;leaf 7&quot;</span>, <span class="st">&quot;leaf 8&quot;</span>, <span class="st">&quot;leaf 9&quot;</span>, <span class="st">&quot;leaf 10&quot;</span>, <span class="st">&quot;leaf 11&quot;</span>,</a>
<a class="sourceLine" id="cb31-14" data-line-number="14">                                            <span class="co"># &quot;dead leaf&quot;, &quot;standing dead&quot;, &quot;microbe mat&quot;,</span></a>
<a class="sourceLine" id="cb31-15" data-line-number="15">                                            <span class="st">&quot;standing dead&quot;</span>, <span class="st">&quot;stems&quot;</span>), ], plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb31-16" data-line-number="16">             <span class="dt">g        =</span> <span class="kw">sum</span>(g_core, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb31-17" data-line-number="17">             <span class="dt">n15      =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb31-18" data-line-number="18">             <span class="dt">n_core   =</span> <span class="kw">sum</span>(n_core, <span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb31-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb31-20" data-line-number="20">abv<span class="op">$</span>g_pg &lt;-<span class="st"> </span>abv<span class="op">$</span>n15 <span class="op">/</span><span class="st"> </span>abv<span class="op">$</span>g</a>
<a class="sourceLine" id="cb31-21" data-line-number="21"></a>
<a class="sourceLine" id="cb31-22" data-line-number="22"><span class="kw">names</span>(abv)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(abv)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>], <span class="st">&quot;.ag&quot;</span>)</a>
<a class="sourceLine" id="cb31-23" data-line-number="23"><span class="kw">names</span>(bgd)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(bgd)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>], <span class="st">&quot;.bg&quot;</span>)</a>
<a class="sourceLine" id="cb31-24" data-line-number="24"></a>
<a class="sourceLine" id="cb31-25" data-line-number="25">comb &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join_all</span>(<span class="kw">list</span>(napp, abv, bgd, mat2), <span class="dt">by =</span> <span class="st">&quot;new.core.id&quot;</span>)</a></code></pre></div>
</div>
<div id="aboveground-tissue-biomass-n-concentrations-15n-recovery" class="section level2">
<h2>Aboveground tissue: Biomass, N concentrations, 15N recovery</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">###</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">### aboveground data</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">###</a>
<a class="sourceLine" id="cb32-4" data-line-number="4"></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">### mass over time in aboveground compartments. mean +- se by species (sum across depth intervals)</a>
<a class="sourceLine" id="cb32-6" data-line-number="6"></a>
<a class="sourceLine" id="cb32-7" data-line-number="7">ag2 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type2 <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;stems&quot;</span>, <span class="st">&quot;leaf&quot;</span>), ],</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">             plyr<span class="op">::</span>.(time, species, new.core.id, sample.type2), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb32-9" data-line-number="9">             <span class="dt">g   =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb32-10" data-line-number="10">             <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_pct, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">             <span class="dt">n   =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb32-12" data-line-number="12">             <span class="dt">n15 =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb32-13" data-line-number="13">             <span class="dt">n15_pg =</span> n15 <span class="op">/</span><span class="st"> </span>(g <span class="op">*</span><span class="st"> </span>pot.m2),</a>
<a class="sourceLine" id="cb32-14" data-line-number="14">             <span class="dt">c13 =</span> <span class="kw">mean</span>(d13c, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb32-15" data-line-number="15">             <span class="dt">cn  =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb32-16" data-line-number="16">)</a>
<a class="sourceLine" id="cb32-17" data-line-number="17"></a>
<a class="sourceLine" id="cb32-18" data-line-number="18">ag2.sp &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(ag2, plyr<span class="op">::</span>.(time, species, sample.type2), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a>
<a class="sourceLine" id="cb32-19" data-line-number="19">ag2.se &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(ag2, plyr<span class="op">::</span>.(time, species, sample.type2), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a>
<a class="sourceLine" id="cb32-20" data-line-number="20"><span class="kw">names</span>(ag2.se)[<span class="dv">4</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(ag2.sp)[<span class="dv">4</span><span class="op">:</span><span class="dv">10</span>], <span class="st">&quot;.se&quot;</span>)</a>
<a class="sourceLine" id="cb32-21" data-line-number="21">ag2.sp &lt;-<span class="st"> </span><span class="kw">cbind</span>(ag2.sp, ag2.se[, <span class="dv">4</span><span class="op">:</span><span class="dv">10</span>])</a>
<a class="sourceLine" id="cb32-22" data-line-number="22">ag2.sp<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">substr</span>(ag2.sp<span class="op">$</span>time, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb32-23" data-line-number="23">ag2.sp<span class="op">$</span>session &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)][<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ag2.sp<span class="op">$</span>time))]</a>
<a class="sourceLine" id="cb32-24" data-line-number="24">ag2.sp<span class="op">$</span>species2 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ag2.sp<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="st">&quot;italic(S.~alterniflora)&quot;</span>, <span class="st">&quot;italic(D.~spicata)&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># Figure S2 - aboveground pools ---------------------------------------</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">ggplot</span>(ag2.sp, <span class="kw">aes</span>(<span class="dt">y =</span> g, <span class="dt">x =</span> session, <span class="dt">colour =</span> species2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>( <span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">%+replace%</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(sample.type2 <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> g <span class="op">-</span><span class="st"> </span>g.se, <span class="dt">ymax =</span> g <span class="op">+</span><span class="st"> </span>g.se),  <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(ag2.sp<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(ag2.sp<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;Biomass (g &quot;</span><span class="op">%.%</span>m<span class="op">^-</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;)&quot;</span>)) <span class="op">+</span><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">400</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="fl">0.9</span>), <span class="dt">legend.text.align =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb33-7" data-line-number="7">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/FigureS2_part1_&quot;, todaysDate, &quot;.png&quot;), width = 75, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="kw">ggplot</span>(ag2.sp, <span class="kw">aes</span>(<span class="dt">y =</span> n_pct, <span class="dt">x =</span> session, <span class="dt">colour =</span> species2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>( <span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">%+replace%</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_grid</span>(sample.type2 <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> n_pct <span class="op">-</span><span class="st"> </span>n_pct.se, <span class="dt">ymax =</span> n_pct <span class="op">+</span><span class="st"> </span>n_pct.se),  <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(ag2.sp<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(ag2.sp<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Tissue N&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>percent) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="fl">0.9</span>), <span class="dt">legend.text.align =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/FigureS2_part2_&quot;, todaysDate, &quot;.png&quot;), width = 75, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
</div>
<div id="belowground-tissue-biomass-n-concentrations-15n-recovery" class="section level2">
<h2>Belowground tissue: Biomass, N concentrations, 15N recovery</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">###</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">### belowground data</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">###</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"></a>
<a class="sourceLine" id="cb36-5" data-line-number="5">### mass over time in belowground compartments. mean +- se by species (sum across depth intervals)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">bg &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>), ],</a>
<a class="sourceLine" id="cb36-7" data-line-number="7">            plyr<span class="op">::</span>.(time, species, new.core.id, sample.type), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">            <span class="dt">g   =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">            <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_pct, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">            <span class="dt">n   =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">            <span class="dt">n15 =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">            <span class="dt">n15_pg =</span> n15 <span class="op">/</span><span class="st"> </span>(g <span class="op">*</span><span class="st"> </span>pot.m2)</a>
<a class="sourceLine" id="cb36-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb36-14" data-line-number="14"></a>
<a class="sourceLine" id="cb36-15" data-line-number="15">bg.sp &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(bg, plyr<span class="op">::</span>.(time, species, sample.type), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a>
<a class="sourceLine" id="cb36-16" data-line-number="16">bg.se &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(bg, plyr<span class="op">::</span>.(time, species, sample.type), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="kw">names</span>(bg.se)[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(bg.se)[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>], <span class="st">&quot;.se&quot;</span>)</a>
<a class="sourceLine" id="cb36-18" data-line-number="18">bg.sp &lt;-<span class="st"> </span><span class="kw">cbind</span>(bg.sp, bg.se[, <span class="dv">4</span><span class="op">:</span><span class="dv">8</span>])</a>
<a class="sourceLine" id="cb36-19" data-line-number="19">bg.sp<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">substr</span>(bg.sp<span class="op">$</span>time, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb36-20" data-line-number="20">bg.sp<span class="op">$</span>session &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)][<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(bg.sp<span class="op">$</span>time))]</a>
<a class="sourceLine" id="cb36-21" data-line-number="21">bg.sp<span class="op">$</span>species2 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bg.sp<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="st">&quot;italic(S.~alterniflora)&quot;</span>, <span class="st">&quot;italic(D.~spicata)&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># Figure S3 - belowground biomass pools --------------------------------------</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">ggplot</span>(bg.sp, <span class="kw">aes</span>(<span class="dt">y =</span> g, <span class="dt">x =</span> session, <span class="dt">colour =</span> species2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>( <span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(sample.type <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> g <span class="op">-</span><span class="st"> </span>g.se, <span class="dt">ymax =</span> g <span class="op">+</span><span class="st"> </span>g.se),  <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(bg.sp<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(bg.sp<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(D.<span class="op">~</span>spicata)), <span class="kw">expression</span>(<span class="kw">italic</span>(S.<span class="op">~</span>alterniflora)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;Biomass (g &quot;</span><span class="op">%.%</span>m<span class="op">^-</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;)&quot;</span>)) <span class="op">+</span><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>), <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/FigureS3_part1_&quot;, todaysDate, &quot;.png&quot;), width = 75, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="kw">ggplot</span>(bg.sp, <span class="kw">aes</span>(<span class="dt">y =</span> n_pct, <span class="dt">x =</span> session, <span class="dt">colour =</span> species2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>( <span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_grid</span>(sample.type <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> n_pct <span class="op">-</span><span class="st"> </span>n_pct.se, <span class="dt">ymax =</span> n_pct <span class="op">+</span><span class="st"> </span>n_pct.se),  <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(bg.sp<span class="op">$</span>species2)[<span class="dv">1</span>], <span class="kw">unique</span>(bg.sp<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(D.<span class="op">~</span>spicata)), <span class="kw">expression</span>(<span class="kw">italic</span>(S.<span class="op">~</span>alterniflora)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Tissue N content&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>percent) <span class="op">+</span><span class="st"> </span><span class="co">#ylim(0, 0.012) +</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb38-9" data-line-number="9">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>), <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/FigureS3_part2_&quot;, todaysDate, &quot;.png&quot;), width = 75, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
</div>
<div id="total-15n-recoveries" class="section level2">
<h2>Total 15N recoveries</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># 15N inventories ---------------------------------------------------------</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="co"># aboveground</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4">ag &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;belowground stems&quot;</span>, <span class="st">&quot;stems&quot;</span>, <span class="st">&quot;leaf&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;leaf &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)), ],</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">            plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">            <span class="dt">g   =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">            <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_pct, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-8" data-line-number="8">            <span class="dt">n   =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">            <span class="dt">n15 =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T) <span class="co"># g per pot</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb40-11" data-line-number="11"></a>
<a class="sourceLine" id="cb40-12" data-line-number="12">agd1 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(ag, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">              <span class="dt">n15.mean    =</span> <span class="kw">mean</span>(n15, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-14" data-line-number="14">              <span class="dt">n15.se      =</span> <span class="kw">se</span>(n15),</a>
<a class="sourceLine" id="cb40-15" data-line-number="15">              <span class="dt">recovery    =</span> <span class="kw">mean</span>(n15 <span class="op">/</span><span class="st"> </span>spike, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-16" data-line-number="16">              <span class="dt">recovery.se =</span> <span class="kw">se</span>(n15 <span class="op">/</span><span class="st"> </span>spike)</a>
<a class="sourceLine" id="cb40-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb40-18" data-line-number="18"><span class="co"># species-level belowground inventory over time</span></a>
<a class="sourceLine" id="cb40-19" data-line-number="19">bgd &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>), ], <span class="co">#, &quot;dead biomass&quot;</span></a>
<a class="sourceLine" id="cb40-20" data-line-number="20">             plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-21" data-line-number="21">             <span class="dt">n15    =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T)</a>
<a class="sourceLine" id="cb40-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb40-23" data-line-number="23">bgd1 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(bgd, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-24" data-line-number="24">              <span class="dt">n15.mean    =</span> <span class="kw">mean</span>(n15, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-25" data-line-number="25">              <span class="dt">n15.se      =</span> <span class="kw">se</span>(n15),</a>
<a class="sourceLine" id="cb40-26" data-line-number="26">              <span class="dt">recovery    =</span> <span class="kw">mean</span>(n15 <span class="op">/</span><span class="st"> </span>spike, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-27" data-line-number="27">              <span class="dt">recovery.se =</span> <span class="kw">se</span>(n15 <span class="op">/</span><span class="st"> </span>spike)</a>
<a class="sourceLine" id="cb40-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb40-29" data-line-number="29"></a>
<a class="sourceLine" id="cb40-30" data-line-number="30">bgd1<span class="op">$</span>type &lt;-<span class="st"> &quot;Belowground&quot;</span></a>
<a class="sourceLine" id="cb40-31" data-line-number="31">agd1<span class="op">$</span>type &lt;-<span class="st"> &quot;Aboveground&quot;</span></a>
<a class="sourceLine" id="cb40-32" data-line-number="32">mgd &lt;-<span class="st"> </span><span class="kw">rbind</span>(agd1, bgd1)</a>
<a class="sourceLine" id="cb40-33" data-line-number="33"></a>
<a class="sourceLine" id="cb40-34" data-line-number="34">tot &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(mat2, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-35" data-line-number="35">             <span class="dt">n15.mean    =</span> <span class="kw">mean</span>(n15_<span class="dv">2</span>, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-36" data-line-number="36">             <span class="dt">n15.se      =</span> <span class="kw">se</span>(n15_<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb40-37" data-line-number="37">             <span class="dt">recovery    =</span> <span class="kw">mean</span>(n15_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>spike, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-38" data-line-number="38">             <span class="dt">recovery.se =</span> <span class="kw">se</span>(n15_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>spike)</a>
<a class="sourceLine" id="cb40-39" data-line-number="39">)</a>
<a class="sourceLine" id="cb40-40" data-line-number="40">tot<span class="op">$</span>type &lt;-<span class="st"> &quot;Total&quot;</span></a>
<a class="sourceLine" id="cb40-41" data-line-number="41"></a>
<a class="sourceLine" id="cb40-42" data-line-number="42"><span class="co"># total recovery combined above + belowground (includes dead aboveground but only live belowground)</span></a>
<a class="sourceLine" id="cb40-43" data-line-number="43">tot.live &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>,</a>
<a class="sourceLine" id="cb40-44" data-line-number="44">                                                 <span class="st">&quot;leaf 1&quot;</span>, <span class="st">&quot;leaf 2&quot;</span>, <span class="st">&quot;leaf 3&quot;</span>, <span class="st">&quot;leaf 4&quot;</span>,</a>
<a class="sourceLine" id="cb40-45" data-line-number="45">                                                 <span class="st">&quot;leaf 5&quot;</span>, <span class="st">&quot;leaf 6&quot;</span>, <span class="st">&quot;leaf 7&quot;</span>, <span class="st">&quot;leaf 8&quot;</span>, <span class="st">&quot;leaf 9&quot;</span>, <span class="st">&quot;leaf 10&quot;</span>, <span class="st">&quot;leaf 11&quot;</span>,</a>
<a class="sourceLine" id="cb40-46" data-line-number="46">                                                 <span class="st">&quot;stems&quot;</span>), ], <span class="co">#, &quot;dead biomass&quot;</span></a>
<a class="sourceLine" id="cb40-47" data-line-number="47">                  plyr<span class="op">::</span>.(time, species, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-48" data-line-number="48">                  <span class="dt">n15    =</span> <span class="kw">sum</span>(n15_g, <span class="dt">na.rm  =</span> T)</a>
<a class="sourceLine" id="cb40-49" data-line-number="49">)</a>
<a class="sourceLine" id="cb40-50" data-line-number="50">tot.live1 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(tot.live, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb40-51" data-line-number="51">                   <span class="dt">n15.mean    =</span> <span class="kw">mean</span>(n15, <span class="dt">na.rm  =</span> T),</a>
<a class="sourceLine" id="cb40-52" data-line-number="52">                   <span class="dt">n15.se      =</span> <span class="kw">se</span>(n15),</a>
<a class="sourceLine" id="cb40-53" data-line-number="53">                   <span class="dt">recovery    =</span> <span class="kw">mean</span>(n15 <span class="op">/</span><span class="st"> </span>spike, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-54" data-line-number="54">                   <span class="dt">recovery.se =</span> <span class="kw">se</span>(n15 <span class="op">/</span><span class="st"> </span>spike)</a>
<a class="sourceLine" id="cb40-55" data-line-number="55">)</a>
<a class="sourceLine" id="cb40-56" data-line-number="56"></a>
<a class="sourceLine" id="cb40-57" data-line-number="57"></a>
<a class="sourceLine" id="cb40-58" data-line-number="58">mgd &lt;-<span class="st"> </span><span class="kw">rbind</span>(mgd, tot)</a>
<a class="sourceLine" id="cb40-59" data-line-number="59"><span class="co"># replace unique times with actual sampling dates using indexing</span></a>
<a class="sourceLine" id="cb40-60" data-line-number="60">mgd<span class="op">$</span>session &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)][<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(mgd<span class="op">$</span>time))]</a></code></pre></div>
</div>
<div id="n-uptake-rates" class="section level2">
<h2>N uptake rates</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># N uptake rates ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="co"># Aboveground: estimate from biomass and weighted average biomass N concentration</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co"># get weighted average of aboveground N concentrations for each core</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4">n_mean &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;belowground stems&quot;</span>, <span class="st">&quot;stems&quot;</span>, <span class="st">&quot;leaf&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;leaf &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)), ],</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">                plyr<span class="op">::</span>.(species, time, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">                <span class="dt">tot_mass =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">                <span class="dt">tot_n    =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">                <span class="dt">tot_c    =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-9" data-line-number="9">                <span class="dt">n_wa =</span> tot_n <span class="op">/</span><span class="st"> </span>tot_mass,</a>
<a class="sourceLine" id="cb41-10" data-line-number="10">                <span class="dt">c_wa =</span> tot_c <span class="op">/</span><span class="st"> </span>tot_mass</a>
<a class="sourceLine" id="cb41-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb41-12" data-line-number="12">n_bg_mean &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>), ],</a>
<a class="sourceLine" id="cb41-13" data-line-number="13">                   plyr<span class="op">::</span>.(species, time, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb41-14" data-line-number="14">                   <span class="dt">tot_mass_bg =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-15" data-line-number="15">                   <span class="dt">tot_n_bg    =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-16" data-line-number="16">                   <span class="dt">tot_c_bg    =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core  <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-17" data-line-number="17">                   <span class="dt">n_wa_bg =</span> tot_n_bg <span class="op">/</span><span class="st"> </span>tot_mass_bg,</a>
<a class="sourceLine" id="cb41-18" data-line-number="18">                   <span class="dt">c_wa_bg =</span> tot_c_bg <span class="op">/</span><span class="st"> </span>tot_mass_bg</a>
<a class="sourceLine" id="cb41-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb41-20" data-line-number="20">bg_del &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(bg, plyr<span class="op">::</span>.(new.core.id), plyr<span class="op">::</span>summarise, <span class="co"># I think all these values are per m2</span></a>
<a class="sourceLine" id="cb41-21" data-line-number="21">                <span class="dt">g_bg     =</span> <span class="kw">sum</span>(g, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-22" data-line-number="22">                <span class="dt">g_froots =</span> <span class="kw">sum</span>(g[sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-23" data-line-number="23">                <span class="dt">g_roots  =</span> <span class="kw">sum</span>(g[sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;coarse roots&quot;</span>)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-24" data-line-number="24">                <span class="dt">n_bg     =</span> <span class="kw">sum</span>(n, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb41-25" data-line-number="25">                <span class="dt">n_pct_bg =</span> <span class="kw">mean</span>(n_pct <span class="op">*</span><span class="st"> </span>g, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>g_bg,</a>
<a class="sourceLine" id="cb41-26" data-line-number="26">                <span class="dt">n_pct_bg2 =</span> n_bg <span class="op">/</span><span class="st"> </span>g_bg,</a>
<a class="sourceLine" id="cb41-27" data-line-number="27">                <span class="dt">n15_bg   =</span> <span class="kw">sum</span>(n15, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb41-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb41-29" data-line-number="29"></a>
<a class="sourceLine" id="cb41-30" data-line-number="30"><span class="co"># all relevant values are per m2</span></a>
<a class="sourceLine" id="cb41-31" data-line-number="31">master &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">join_all</span>(<span class="kw">list</span>(napp[, <span class="kw">c</span>(<span class="st">&quot;napp.MH&quot;</span>, <span class="st">&quot;new.core.id&quot;</span>)], <span class="co"># primary production</span></a>
<a class="sourceLine" id="cb41-32" data-line-number="32">                        rgr.stems,</a>
<a class="sourceLine" id="cb41-33" data-line-number="33">                        n_mean, n_bg_mean[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)], <span class="co"># N inventories above and belowground</span></a>
<a class="sourceLine" id="cb41-34" data-line-number="34">                        ag[, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>], bg_del <span class="co"># 15N recoveries and unweighted average pct N</span></a>
<a class="sourceLine" id="cb41-35" data-line-number="35">), <span class="dt">by =</span> <span class="st">&quot;new.core.id&quot;</span>)</a>
<a class="sourceLine" id="cb41-36" data-line-number="36">master<span class="op">$</span>napp.MH  &lt;-<span class="st"> </span>master<span class="op">$</span>napp.MH <span class="op">/</span><span class="st"> </span>pot.m2 <span class="co"># g/m2</span></a>
<a class="sourceLine" id="cb41-37" data-line-number="37">master<span class="op">$</span>n15_core &lt;-<span class="st"> </span>master<span class="op">$</span>n15 <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n15_bg <span class="co"># total live biomass inventory</span></a>
<a class="sourceLine" id="cb41-38" data-line-number="38">master<span class="op">$</span>recovery &lt;-<span class="st"> </span>master<span class="op">$</span>n15_core <span class="op">/</span><span class="st"> </span>spike</a>
<a class="sourceLine" id="cb41-39" data-line-number="39">master<span class="op">$</span>session  &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)][<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(master<span class="op">$</span>time))]</a>
<a class="sourceLine" id="cb41-40" data-line-number="40">master<span class="op">$</span>timeDiff &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">difftime</span>(master<span class="op">$</span>session, <span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="dv">1</span>], <span class="dt">units =</span> <span class="st">&quot;days&quot;</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co"># fertilized applied on 23 June</span></a>
<a class="sourceLine" id="cb41-41" data-line-number="41"></a>
<a class="sourceLine" id="cb41-42" data-line-number="42">master<span class="op">$</span>n_uptake_15n     &lt;-<span class="st"> </span>master<span class="op">$</span>n15 <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span> <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>timeDiff <span class="op">/</span><span class="st"> </span>pot.m2 <span class="co"># mg N/day/m2 accumulating in aboveground tissue, using 15N</span></a>
<a class="sourceLine" id="cb41-43" data-line-number="43">master<span class="op">$</span>n_uptake_15n_bg  &lt;-<span class="st"> </span>master<span class="op">$</span>n15_bg <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span> <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>timeDiff <span class="op">/</span>pot.m2 <span class="co"># mg N/day/m2</span></a>
<a class="sourceLine" id="cb41-44" data-line-number="44">master<span class="op">$</span>prodn_rate       &lt;-<span class="st"> </span>master<span class="op">$</span>napp.MH <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>timeDiff <span class="co"># g/m2/day</span></a>
<a class="sourceLine" id="cb41-45" data-line-number="45">master<span class="op">$</span>n_uptake_biomass &lt;-<span class="st"> </span>master<span class="op">$</span>prodn_rate <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span> <span class="op">*</span><span class="st"> </span>master<span class="op">$</span>n_wa <span class="co"># mg N/m2/day accumulating in aboveground tissue, using primary production rate and weighted average pct N</span></a>
<a class="sourceLine" id="cb41-46" data-line-number="46">master<span class="op">$</span>cn_ag    &lt;-<span class="st"> </span>master<span class="op">$</span>c_wa <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>n_wa <span class="co"># C:N ratio in aboveground tissue</span></a>
<a class="sourceLine" id="cb41-47" data-line-number="47">master<span class="op">$</span>cn_bg    &lt;-<span class="st"> </span>master<span class="op">$</span>c_wa_bg <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>n_wa_bg</a>
<a class="sourceLine" id="cb41-48" data-line-number="48">master<span class="op">$</span>cluster  &lt;-<span class="st"> </span><span class="kw">ifelse</span>(master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>), <span class="st">&quot;1-2 weeks&quot;</span>, <span class="st">&quot;3-4 weeks&quot;</span>)</a>
<a class="sourceLine" id="cb41-49" data-line-number="49">master<span class="op">$</span>n15_pgBG &lt;-<span class="st"> </span>(master<span class="op">$</span>n_uptake_15n <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_15n_bg) <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>g_bg <span class="co"># 15N uptake per gram belowground biomass: mg 15N/m2/day/g TOTAL BG biomass</span></a>
<a class="sourceLine" id="cb41-50" data-line-number="50">master<span class="op">$</span>n15_pgFR &lt;-<span class="st"> </span>(master<span class="op">$</span>n_uptake_15n <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_15n_bg) <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>g_froots <span class="co"># 15N uptake per gram coarse roots: mg 15N/m2/day/g fine roots</span></a>
<a class="sourceLine" id="cb41-51" data-line-number="51">master<span class="op">$</span>n15_pgCR &lt;-<span class="st"> </span>(master<span class="op">$</span>n_uptake_15n <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_15n_bg) <span class="op">/</span><span class="st"> </span>(master<span class="op">$</span>g_roots <span class="op">-</span><span class="st"> </span>master<span class="op">$</span>g_froots) <span class="co"># 15N uptake per gram coarse roots: mg 15N/m2/day/g coarse roots</span></a>
<a class="sourceLine" id="cb41-52" data-line-number="52">master<span class="op">$</span>n15_pgR  &lt;-<span class="st"> </span>(master<span class="op">$</span>n_uptake_15n <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_15n_bg) <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>g_roots <span class="co"># 15N uptake per gram fine+coarse root biomass: mg 15N/m2/day/g root biomass</span></a>
<a class="sourceLine" id="cb41-53" data-line-number="53">master<span class="op">$</span>n15_pgFR2 &lt;-<span class="st"> </span>master<span class="op">$</span>n15_core <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span> <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>g_froots</a>
<a class="sourceLine" id="cb41-54" data-line-number="54">master<span class="op">$</span>tot_15n_uptake &lt;-<span class="st"> </span>master<span class="op">$</span>n_uptake_15n <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_15n_bg <span class="co"># mg N/day/m2</span></a>
<a class="sourceLine" id="cb41-55" data-line-number="55"></a>
<a class="sourceLine" id="cb41-56" data-line-number="56"></a>
<a class="sourceLine" id="cb41-57" data-line-number="57"><span class="kw">summary</span>(lm.sa &lt;-<span class="st"> </span><span class="kw">lm</span>(n15_pgFR <span class="op">~</span><span class="st"> </span>timeDiff, <span class="dt">data =</span> master[master<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, ]))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = n15_pgFR ~ timeDiff, data = master[master$species %in% 
##     &quot;SA&quot;, ])
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0158823 -0.0050676  0.0005705  0.0057714  0.0117488 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.0360954  0.0064459   5.600 0.000228 ***
## timeDiff    -0.0006667  0.0003209  -2.077 0.064469 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.0087 on 10 degrees of freedom
## Multiple R-squared:  0.3015, Adjusted R-squared:  0.2316 
## F-statistic: 4.316 on 1 and 10 DF,  p-value: 0.06447</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">summary</span>(lm.ds &lt;-<span class="st"> </span><span class="kw">lm</span>(n15_pgFR <span class="op">~</span><span class="st"> </span>timeDiff, <span class="dt">data =</span> master[master<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;DS&quot;</span>, ]))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = n15_pgFR ~ timeDiff, data = master[master$species %in% 
##     &quot;DS&quot;, ])
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.045272 -0.018414 -0.000927  0.015866  0.044623 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.116198   0.020772   5.594  0.00023 ***
## timeDiff    -0.002241   0.001034  -2.167  0.05543 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.02803 on 10 degrees of freedom
## Multiple R-squared:  0.3196, Adjusted R-squared:  0.2515 
## F-statistic: 4.697 on 1 and 10 DF,  p-value: 0.05543</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># Calculate intersection of lines of best fit</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">rightSide &lt;-<span class="st"> </span>lm.ds<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>lm.sa<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">leftSide  &lt;-<span class="st"> </span>lm.sa<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>lm.ds<span class="op">$</span>coefficients[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb45-4" data-line-number="4"></a>
<a class="sourceLine" id="cb45-5" data-line-number="5">leftSide <span class="op">/</span><span class="st"> </span>rightSide <span class="co"># days until no difference detectable</span></a></code></pre></div>
<pre><code>## (Intercept) 
##    50.87775</code></pre>
</div>
<div id="analysis-of-n-uptake-drivers" class="section level2">
<h2>Analysis of N uptake drivers</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">summary</span>(lm.mv &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(tot_15n_uptake <span class="op">~</span><span class="st"> </span>(napp.MH <span class="op">+</span><span class="st"> </span>rgr <span class="op">+</span><span class="st"> </span>g_roots <span class="op">+</span><span class="st"> </span>session) <span class="op">*</span><span class="st"> </span>species, <span class="dt">data =</span> master))</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = tot_15n_uptake ~ (napp.MH + rgr + g_roots + 
##     session) * species, data = master)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.22734 -0.92744 -0.05543  0.89018  1.94193 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)        7.973e+03  2.023e+03   3.941  0.00148 **
## napp.MH            2.083e-02  1.235e-02   1.687  0.11377   
## rgr                8.055e+01  5.968e+01   1.350  0.19856   
## g_roots           -7.399e-03  7.688e-03  -0.962  0.35217   
## session           -5.428e-06  1.378e-06  -3.938  0.00148 **
## speciesSA         -3.794e+03  2.723e+03  -1.393  0.18532   
## napp.MH:speciesSA -3.518e-02  2.581e-02  -1.363  0.19447   
## rgr:speciesSA     -8.492e+00  7.891e+01  -0.108  0.91583   
## g_roots:speciesSA  1.758e-03  1.118e-02   0.157  0.87736   
## session:speciesSA  2.586e-06  1.854e-06   1.395  0.18490   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.657 on 14 degrees of freedom
## Multiple R-squared:  0.7591, Adjusted R-squared:  0.6042 
## F-statistic: 4.901 on 9 and 14 DF,  p-value: 0.004198</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">summary</span>(lm3_<span class="dv">4</span> &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">lm</span>(n_uptake_biomass <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(n_uptake_15n ) , <span class="dt">data =</span> master[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t3&quot;</span>, <span class="st">&quot;t4&quot;</span>), ]))</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = n_uptake_biomass ~ I(n_uptake_15n), data = master[master$time %in% 
##     c(&quot;t3&quot;, &quot;t4&quot;), ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -58.818 -16.952  -4.347  18.213  43.546 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)       -9.456     32.024  -0.295   0.7738  
## I(n_uptake_15n)   46.481     15.005   3.098   0.0113 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 31.47 on 10 degrees of freedom
## Multiple R-squared:  0.4897, Adjusted R-squared:  0.4387 
## F-statistic: 9.596 on 1 and 10 DF,  p-value: 0.01129</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">dd.master &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(master, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">dd.master.se &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(master, plyr<span class="op">::</span>.(time, species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">dd.master<span class="op">$</span>n_uptake_biomass.se &lt;-<span class="st"> </span>dd.master.se<span class="op">$</span>n_uptake_biomass</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">dd.master<span class="op">$</span>prodn_rate.se &lt;-<span class="st"> </span>dd.master.se<span class="op">$</span>prodn_rate</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">dd.master<span class="op">$</span>session &lt;-<span class="st"> </span><span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)][<span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(dd.master<span class="op">$</span>time))]</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># Figure 2a - Aboveground biomass over time ----------------------------------</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">ggplot2<span class="op">::</span><span class="kw">ggplot</span>(ddHgt4[ddHgt4<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, ], ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">y =</span> mass <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">x =</span> session, <span class="dt">colour =</span> species, <span class="dt">shape =</span> species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_errorbar</span>(ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">ymin =</span> (mass <span class="op">-</span><span class="st"> </span>mass.se) <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">ymax =</span> (mass <span class="op">+</span><span class="st"> </span>mass.se) <span class="op">/</span><span class="st"> </span>pot.m2), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(ddHgt4<span class="op">$</span>species[ddHgt4<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>], <span class="kw">unique</span>(ddHgt4<span class="op">$</span>species[ddHgt4<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(ddHgt4<span class="op">$</span>species[ddHgt4<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">1</span>], <span class="kw">unique</span>(ddHgt4<span class="op">$</span>species[ddHgt4<span class="op">$</span>cohort <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">scale_x_datetime</span>(<span class="dt">breaks =</span> <span class="kw">unique</span>(ddHgt4<span class="op">$</span>session)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>)], <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">date_format</span>(<span class="st">&quot;%b-%d&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">600</span>) <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cohort, <span class="dt">labeller =</span> label_parsed) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Biomass (g &quot;</span><span class="op">%.%</span>m<span class="op">^-</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;)&quot;</span>), <span class="dt">x =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.125</span>, <span class="fl">0.87</span>), <span class="dt">legend.text.align =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>), <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure2_&quot;, todaysDate, &quot;.png&quot;), width = 120, height= 70, units = &quot;mm&quot;, dpi = 400)</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"></a>
<a class="sourceLine" id="cb53-3" data-line-number="3"></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"></a>
<a class="sourceLine" id="cb53-5" data-line-number="5"><span class="co"># Figure 2b - NAPP ------------------------------------------</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6"><span class="co"># set dodge width for points &amp; error bars</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7">pd &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb53-8" data-line-number="8"></a>
<a class="sourceLine" id="cb53-9" data-line-number="9"><span class="kw">ggplot</span>(dd.master, <span class="kw">aes</span>(<span class="dt">y =</span> prodn_rate, <span class="dt">x =</span> <span class="kw">as.Date</span>(session), <span class="dt">shape =</span> species, <span class="dt">colour =</span> species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb53-10" data-line-number="10"><span class="st">  </span><span class="co"># facet_wrap(~ species) +</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> prodn_rate <span class="op">-</span><span class="st"> </span>prodn_rate.se, <span class="dt">ymax =</span> prodn_rate <span class="op">+</span><span class="st"> </span>prodn_rate.se), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-14" data-line-number="14"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">15</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;Primary production (g&quot;</span><span class="op">%.%</span>m<span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}<span class="op">%.%</span><span class="st">&quot;d&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">~</span><span class="st">&quot;)&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">scale_x_date</span>(<span class="dt">breaks =</span> <span class="kw">as.Date</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>session)), <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">date_format</span>(<span class="st">&quot;%b-%d&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb53-17" data-line-number="17">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-18" data-line-number="18"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>session)[<span class="dv">3</span>]), <span class="dt">y =</span> <span class="dv">12</span>, <span class="dt">label =</span> <span class="st">&quot;**&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-19" data-line-number="19"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>session)[<span class="dv">4</span>]), <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure2_lowerPanel_&quot;, todaysDate, &quot;.png&quot;), width = 120, height= 70, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co"># Figure 3 - Aboveground N uptake  ----------------------------------------</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">ggplot</span>(dd.master, <span class="kw">aes</span>(<span class="dt">y =</span> n_uptake_biomass, <span class="dt">x =</span> session, <span class="dt">shape =</span> species, <span class="dt">colour =</span> species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="st">  </span><span class="co"># facet_wrap(~ species) +</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> n_uptake_biomass <span class="op">-</span><span class="st"> </span>n_uptake_biomass.se, <span class="dt">ymax =</span> n_uptake_biomass <span class="op">+</span><span class="st"> </span>n_uptake_biomass.se), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(dd.master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">200</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-8" data-line-number="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;N uptake (mg N&quot;</span><span class="op">%.%</span>d<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">%.%</span><span class="st">&quot;m&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}<span class="op">~</span><span class="st">&quot;; primary prod.)&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb55-10" data-line-number="10">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-11" data-line-number="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">unique</span>(dd.master<span class="op">$</span>session)[<span class="dv">3</span>], <span class="dt">y =</span> <span class="dv">155</span>, <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-12" data-line-number="12"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">unique</span>(dd.master<span class="op">$</span>session)[<span class="dv">4</span>], <span class="dt">y =</span> <span class="dv">135</span>, <span class="dt">label =</span> <span class="st">&quot;*&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure3_.png&quot;), width = 80, height= 80, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># Figure 4 - 15N recoveries ------------------------------------------------</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">ggplot</span>(mgd[<span class="op">!</span>mgd<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t0&quot;</span>, ], <span class="kw">aes</span>(<span class="dt">x =</span> session, <span class="dt">y =</span> recovery, <span class="dt">colour =</span> species, <span class="dt">shape =</span> species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Recovery (decimal fraction)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> recovery <span class="op">-</span><span class="st"> </span>recovery.se, <span class="dt">ymax =</span> recovery <span class="op">+</span><span class="st"> </span>recovery.se), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">unique</span>(mgd<span class="op">$</span>species), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">unique</span>(mgd<span class="op">$</span>species), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>type)  <span class="op">+</span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="fl">0.85</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.15</span>, <span class="fl">0.9</span>), <span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb57-8" data-line-number="8">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>), <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>,<span class="dt">hjust=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure4_&quot;, todaysDate, &quot;.png&quot;), width = 120, height= 90, units = &quot;mm&quot;, dpi = 400)</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"></a>
<a class="sourceLine" id="cb58-3" data-line-number="3"></a>
<a class="sourceLine" id="cb58-4" data-line-number="4"></a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="co"># Figure 5 - 15N uptake per gram fine roots ---------------------------------</span></a>
<a class="sourceLine" id="cb58-6" data-line-number="6">rt2 &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(master, plyr<span class="op">::</span>.(species, timeDiff), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb58-7" data-line-number="7">             <span class="dt">xbar =</span> <span class="kw">mean</span>(n15_pgFR, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb58-8" data-line-number="8">             <span class="dt">se =</span> <span class="kw">se</span>(n15_pgFR))</a>
<a class="sourceLine" id="cb58-9" data-line-number="9"><span class="kw">ggplot</span>(rt2, <span class="kw">aes</span>(<span class="dt">x =</span> timeDiff, <span class="dt">y =</span> xbar, <span class="dt">colour =</span> species, <span class="dt">shape =</span> species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb58-10" data-line-number="10"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)  <span class="op">+</span><span class="st"> </span><span class="co">#xlim(0, 9) +</span></a>
<a class="sourceLine" id="cb58-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> xbar <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> xbar <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Experiment duration (days)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-13" data-line-number="13"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;N uptake (mg &quot;</span><span class="op">^</span>{<span class="dv">15</span>}<span class="op">~</span>N<span class="op">%.%</span>d<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">%.%</span><span class="st">&quot;m&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}<span class="op">%.%</span><span class="st">&quot;gdw&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">~</span><span class="st">&quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">unique</span>(rt2<span class="op">$</span>species), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(rt2<span class="op">$</span>species)), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>),</a>
<a class="sourceLine" id="cb58-17" data-line-number="17">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAA/1BMVEUAAAAAADoAAGYAOpAAZpAAZrYZGRkzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOpBmkJBmtrZmtv9uTU1uTW5uTY5ubqtuq+SMjIyOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQkGaQkLaQkNuQtpCQ27aQ29uQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq225C22/+2/7a2/9u2///Ijk3I///bkDrbkGbbtmbb25Db/7bb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///94pbyfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASaElEQVR4nO2dB3/bxhmHKbsUZbdpStqynLTykIfUNF1SEjFdktgRCWLLhe//WYobWMTgHV+MF7j/87NkEAAPR76PbgEHDHwACAzazgDoNhAIkIBAgAQEAiQgECABgQCJKgSChA4DgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAwjD4q4+T4we5tHgzmZwnV0AgpzEL/ubq3L9/JZZWn679xdvreIVxGqCXmAV/9fnOX7y7C5YehTW35/EK4zRALzEL/uL9gyx7FMFSvGI0GkEghzEL/uNxQqDN1Vl6BQRyGPsSaPXxbKtIgkAOY9sGCnph5+kVEMhpTHthZ7rTpfxJrDBOA/QSq3GgoMy5nwjOMQ4EFBiJBiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEpngzwaSMSUN4A7p4C9PQnNmg4PL/dIATpEK/vKrm4IX5mkAt0AbCJCAQIAEBAIkIBAgAYEACQgESECgHjCLhn7Xv41G79bf3KRfh4tiIbGeSBT85YkcgX5iOviTlwZohA8fPqRXTE9F/E7TK72nP6VeR+N68y/SG2jEwd8/XQjUCB+yqA1KDW/oqyCKouDUnx8NhjqoU1k8zb/4iyoevHC92pFIIvizfRODQI1QKJD605e/vcCU6difP7+RxZJ6PZSKeT8f+zNRz4lfYn24Iw20gTpHQh2F1EJVWcIaTzaHVCsneB06EngklFH7KLusTpkXkAr++vf0NEDtbLeBpA3+bBg1lKcHl6peE691WyhqOifb0FPzM+ZFQKDOo2xYvr5UrSEhUlAmqVaOqLqGci+xKKWSzSSxoHckAoE6j1RlfTHWi17QUg6qqqhNHVRhYqNclM2ksA2tdyQCgTqPJ4ZfVF2k2sYD0f/y5C/ZaJadMC9sOkdtaL0jEQgESGwHf3liPzQAgRwmE/z1hfWANARymPzgry9sDIJADpMXfM9yhBsCOUxeFfbU8qQYBHKYbCPa/owYBHKYbPCnKIGAOXnBnx+hDQQMKQj+FL0wYEQm+EHxg7nxwJickWjr82sQyGFwQRkgkb65grqw3vZcBgRqGRG34oBtT8+oluz9gURO7EaDIFDDHKZfri+CaM0KB1+2p2dUS8FAoocSiC+HWwLJ6wvlFYner/R5hOlA/u/97OLpv6PpGcuv/6WuG9JbKwECdYbDLHpLdGmzWBAXGc70BfQzsSGaniGuMZsltlZCURWGbjw7igUKT3/Lho6+BloqIn6i6RnqIujE1krIBl9eIbndBFp9nBw/6OXFuzvfv59MJi/vitIA9ZFWJ2R+JGanfq2veZ6qGEp3oukZ/o+6OJrmRXhfzIK/uTr371+p5Ucpzu25bRqgJtTEr1k0D3Usm82iTSRfR9Mz5M/ry2hrNZgFf/X5ThU8gTkvfggWNt9d26YBakJOyJBtV9FyFU0QoYg4GSVrs3h6hv4Jt1ZDzki0JnnB/uL9g7/6pJ0RJgVV2mQiC6HRaASB2kXGTFRJ0y9P1HhQUEn9MiiX5KyvaHqGMEnapLdWQ2Ejen2RMOjxeEugxdvruBSCQDyQ40FNU9yNT/bkMyWQJGwHQSAemN+YuULMBEq0gSAQSFI8DpQcG99cnUW9MCmQqNM236MbDwrHgWapGzeocSBV9oTjQC+uC9MAzoDLOQAJCARIQCBAAgIBEnnBtx3nhkAOgxIIkIBAgAQEAiQgECABgQCJOPjyulo5h2j/NIBzRMEXV81OTyEQsCN+3JO4IPvHP0MgYEWqBAp+/QICARsSzwsTl8nu9fgfCOQwuFM9IAGBAAkIBEhAIEACAgESOJUBSBTdpRX3BwJGbAc/NaN5zzSAQ+BZGYBEtgSCQMCCTPCt7o5YkAZwBzSiAYlsFWZ/90UI5DBoRAMSaEQDEtk2kP0VQRDIYYpusolGNDAC58IACQgESEAgQAICARK4PxAggRIIkIBAgAQEAiQgECABgQCJGgX6UEHSgDvx7V1OrM+BZdJIA4FcIHF3ji/2fZQ4BHKYRPBn+z7vDgI5DNpAgESNc+MhkAtAIEACAgESEAiQgECABHphgEQq+OGUjGpmZUAgFyh6brzNoCIEcpiCqc1W9+iAQA4DgQCJoirM5h4dEMhhssH3RBva6rwqBHIYdOMBCQgESEAgQAICARI1Tm2GQC6AEgiQgECAhKFAq4+T4we9vHh3l14BgRzG7Gz85urcv3+llh8nL+9SKyCQy+QHfzpIn8pYfb5TBY/v3774IVhIrIBATpMX/OXJwWV6zeL9g7/6dK1fBOLEK0ajEQRymJzge4On23NUH4+3BEqt6JhAXPPVTbLBnw6yj5wrKYFy05BwDRTXfHWT7KMO8s7Ep5o8C9M2UILK8lsBrDLTebaCPz/KHYXeXJ3FnS4hTmpFvkAfMlSVZyJc8tEP0sGf5VRfEjXso8ocs3GgtDKcNGo/B/lwzVc5tc3KyJGFSWnENVBc81VObacyCjVpXSOugeKar3LqOxdW7keLFnENFNd8ldPuydRWNOIaKK75KofB2fim6zSugeKar3IYCKT3bkwjroHimq9y2Aik39PA2BHXQHHNVznxbX6//inoxe9zl9/qT2XUqxHXQHHNVzlJgX68FL8JaaSp5AupQSOugeKar3K2BFp/w/JG45VaxDVQXPNVTuJO9cN/MiyBUglWoxHXQHHNVzmJ4HuD4fL1ZfGuJmkkqecLoddpXAPFNV/lMOuFmULRiGuguOarnI4KpI+wl0ZcA8U1X+X04Gk9tp1+roHimq9yevO0HnONuAaKa77K6ePTenZoxDVQXPNVTqfbQKUUWsQ1UFzzVU5/BVLkaMQiXzlwzVc5fRdIkq7T+OQrDdd8leOEQIoaTqtVCstM7SR7n+jwsvqC+RkGaWh4fiF8LeKWHzMK7xO9vjA2qFMCqWu1OWrEJyc2FN+p3vxm9Z0SKCFNZuio3Rzz/L524bJAiRUcLOL5fe2i+FEHs8w9OozTUPD8QkodaVOjtgvAPSl81MFs+x5BNmlImH4fOwPVTmnUfhW6Hw5140PM8tW0RhAoA9evwyZfzWnUG4HmR31/5KV9vhqxqJv+5NxgynwAsSgNDdfvY9981a0R1++rnIJuPCkNDdcvhHZFfn29fq7fVznZEggCGSRRh0Vcv69yMsG3elpqQRq8qThQlWnUE4Gqa0RzpZb59hVo1A+B1hc2j9vNT4M59QWKplE/BKqwEc2VugO1r0X9EKjCRjRXmgmUvUb9EMifP0cjurpD2WjUD4HCKxLRiK7wgGYa9UOgttJokJYCtXPsCAJ1hFYDVaJRDwRafnVT8MI8Df5wCdS2RlzyZUc6+EELSHfCZgPyBWVc4RWoqk+INE0m+FPViLYZToRAZLprEdpAbPjQSY0gEBtyJhu1myEjIBAbCicbtZUhIyAQG3LytXPsqH0gEBtMZqvx0wgCscEkX/w0ygZ/Nhicms9KzU+DNUy++Qzm+eJkUXYc6Ol/Tk7t5mZ0TCCu2MrAQ6OcC8rENWVWV0ZDoErYS4PW6zQIxAaCAC1qlL07h6jCxN05CGmAVmjFooK7c1hdWQ+BONGwRg52410gM3RUm0wQqMc0oVGmEf0H+Z/VkwshUAeoy6JsL0w0f6Z9vqjeZarXKGdq89jmasTcNABrKq3TssGPL2vdPw3An4o0ygn+8sTyHlMQqLuQLUrPyoiec4A2kFMQNEI3Hmj26/QbBn/1cXL8kFy6n0wmL++s0gBdwNYisxtMba7O/ftXyaXb85I0QD/YR6D1xXh9cbp9l6DV5zt/8e4uXtp8d12cBnCIvBtMTce+l74kcfH+wV99uo6XgopsMpGF0Gg0gkB9ZkcRlCfQbLh9PdDjcSiQXlq8vfajUggC9RlLgfyptGe2owSSa8N2EATqM7YCibtsTrfPZWTaQHItBHIBW4Fy2VydRb0wuSRqss336MY7wB5tID97u3E1+iOKnngc6MV1QRqgT1QjkFUaoEfsGglKB38WnQvDvDAg2DmW6OCNxoEF1gLtAwTqL3sINFMP3bUAAvUYuzaQn3jstzkQqM+gFwZIQCBAwnYk2hNnMVCFgRDrEsj+smgI1GcqORe2VxqHFSQNWgcCgTqp73lhh4cwyAHyg798bTO3OTeNQwjkBAXVj2dzm9ZCgWBQ/ykSiFqFHR7CICcoEGhKLoHQiHaDgka01f1dIJDDoBsPSOB6IEACAgESEAiQqLMNhI68A9QuUAEVHBZwoPZb3JVqBK86T37wp7U/Nx5G9YS84C9PWrtPNLzqGjnB9wZWD7ystxeGGpA52eBPraY156dRO330qiPZ3CJ7j0Tb+9RzGgfqslIsM7WbreDPj2y6X/lp8KMLXjHVeifbd+ewrb6yaXQCflVgLwRy/lEH7XnVegm4LzgXZkAzRnVRHwhEgVMN2BoQqELaqwHbAwLVT7e92pEhCNQaHVEKAnUMbl5BoM7TbhUIgfpKQ15BIMeo2KhdezooELt+TiPs6xUEyuCmQBkqqv7cE6jtbjFzbA1yTiCL6h8I0IhOA4EsgUAprHogwIdAWaCPFRBoGwhkBQTaBgJViYMCgSqBQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQMIw+KuPk+OH5FK8AgI5jVnwN1fn/v2rxFK8wjgN0EvMgr/6fOcv3t3FS/EK4zRALzEL/uL9g7/6dB0vxStGoxEEchiz4D8eh77opXiFcRqgl5BLIOM0QC9BGwiQMO2FnUW9sDPVCztDLwz4luNAoszBOBBIgpFoQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQKISgciM6EnwPFh/P1iVAtEZ7d6lmwfr/weDQL05FgTq4cH6/8F4CAQ6CwQCJCAQIAGBAAkIBEi0L5C8Nj95hWztB7ufTCYv7+o+0pvJ5LypD6YP1sgHe1THCD9Y6wI9iuykZkrXfTD/9rz+I4k5T4u31818MH2wRj6Y+BNMzm1vW6DbFz+IK/WTs4TqPtjmu+u6DxSoKr7c2/NmPpg+WCMfTJCc19W2QErp1DzFug8WFL6ywK+d7QmYdR+ssQ8WFD3RB+MhUGqmdN0HE4V9E3+sYu5cYx9MHKyhD7Z48+I6/mA8BGq0BJLU31xYfTzzG/tg8mCShhp4zEqghtpATQq0eCOO0NAHUweTNCFQsnHHQ6DUTOm6DyZK3833NQdVh7SZD6YP1sgH03VX9MF4CNT4ONCLumsVMSQjWrSNfLDwYE18sPAgbMaBQLeBQIAEBAIkIBAgAYEACQgESEAgQAICARKOCLS+UBMqn9yU7TV/dlmezH//Fi97RWkFOxUmtL44LX+zv3y9Iw/McEagcQWppLwocqDUwtmw/M1i09Of9spcS0AgC8gCRcVLiUBhIdURnBNodnDpL0/G82ffDgbib11UbkE0589/N3jy12eX82d/PBoMxvPg12m8Ua48FStVMsuTwcG3T26kK8Ev+eYbsVm9cyw2iPcO/fC9+uDiiPrNvtrfn4pCKSiZ5EuxX7eKIOcEEgGbinA9uVlfDH3xI+I6PxoqF46C8M2EWjO1g9qoXoeFSyBg8JMQSLx5eRJEX+8U/ISJh++NchG+OdxfFEZBqaPSOjo1aImxwhmBVCN6LIuE5zdRqGRdEsQyfK3+L9qoQyvXz5ICBdv/J8oNvVP4Xk+US7ET0pnwzeH+YuX8+U3wT+dV7tUZnBEobgPNBmFIg1DNtFiRC/p/+St3o69rIhH09Hov2PcgEkjuk0wwLKT0m8P9RfUl2tZTWeP5VbXXmsJBgaaqaaIF0g2OfIHyNvoFAi1PDi6TJdAugcL9g+V/qHZz0DgSpRMEYkgiKN6Tv4tKQ9Ysz2+8A+VErkC5G31dC3lP0gJJY7y4BBLvTewj3hdXYcGvcP8gb78Oqy+5A6owhsQCifDIpknYiA7iqMOeEWh7Yxja5clQt4PHQQJ6u3BhfnSg2jSJRnRCIH86jt8c7i/q1KH2KrVzN3BGINWcObicBk4EgZXd+KHeouuSjEDbG1Xt56d74r95rUumoBFz8KfAnmCnVDc+4YSX7MaH+6vSMGwR6TquMzgiUIZ2/szzz1PEHTABBhI7QUv1RHgqI70y1Wju1jgiBGqWnOJFjjTG4GQqcAoIBEhAIEACAgESEAiQgECABAQCJP4PNt4J9S1AmwIAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure5_&quot;, todaysDate, &quot;.png&quot;), width = 100, height= 100, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
</div>
<div id="estimating-belowground-production-using-15n" class="section level2">
<h2>Estimating belowground production using 15N</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">### apply relationship to estimate belowground production</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"></a>
<a class="sourceLine" id="cb60-3" data-line-number="3">lm3_<span class="dv">4</span></a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = n_uptake_biomass ~ I(n_uptake_15n), data = master[master$time %in% 
##     c(&quot;t3&quot;, &quot;t4&quot;), ])
## 
## Coefficients:
##     (Intercept)  I(n_uptake_15n)  
##          -9.456           46.481</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">master<span class="op">$</span>bg_n_est &lt;-<span class="st"> </span><span class="kw">I</span>(master<span class="op">$</span>n_uptake_15n_bg) <span class="op">*</span><span class="st"> </span><span class="kw">coefficients</span>(lm3_<span class="dv">4</span>)[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coefficients</span>(lm3_<span class="dv">4</span>)[<span class="dv">1</span>] <span class="co"># total N uptake belowground: mg N/m2/day</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2">master<span class="op">$</span>bg_n_est[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb62-3" data-line-number="3">master<span class="op">$</span>bgp_est &lt;-<span class="st"> </span>master<span class="op">$</span>bg_n_est <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>n_pct_bg2 <span class="op">/</span><span class="st"> </span><span class="fl">1e3</span> <span class="co"># [estimated total N uptake (mg N/day)] / [mg N / mg biomass] / [1000 mg/g] = [g belowground biomass / day (/m2)]</span></a>
<a class="sourceLine" id="cb62-4" data-line-number="4">master<span class="op">$</span>bgp_biomass_est &lt;-<span class="st"> </span>master<span class="op">$</span>bgp_est <span class="op">*</span><span class="st"> </span>master<span class="op">$</span>timeDiff <span class="co"># [g belowground biomass / day] * [timeDiff (days)] = total belowground production during period [g/m2]</span></a>
<a class="sourceLine" id="cb62-5" data-line-number="5"></a>
<a class="sourceLine" id="cb62-6" data-line-number="6"><span class="kw">summary</span>(master<span class="op">$</span>bgp_est <span class="op">/</span><span class="st"> </span>master<span class="op">$</span>prodn_rate)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##  0.3474  0.7885  1.1485  1.7446  1.6324  7.0683      12</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">### differences in total nitrogen interception between species</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">master<span class="op">$</span>tot_N_int &lt;-<span class="st"> </span>master<span class="op">$</span>bg_n_est <span class="op">+</span><span class="st"> </span>master<span class="op">$</span>n_uptake_biomass <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(master<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>, <span class="kw">nmolHr_mgDay</span>(dd.dea<span class="op">$</span>flux.m2[<span class="dv">2</span>]), <span class="kw">nmolHr_mgDay</span>(dd.dea<span class="op">$</span>flux.m2[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">master<span class="op">$</span>tot_N_int[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="kw">summary</span>(aov.sp1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_N_int <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> master))</a></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## species      1  47761   47761   18.62 0.00153 **
## Residuals   10  25656    2566                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 12 observations deleted due to missingness</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov.sp2 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_N_int <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> master))</a></code></pre></div>
<pre><code>## Anova Table (Type II tests)
## 
## Response: tot_N_int
##           Sum Sq Df F value   Pr(&gt;F)   
## species    47761  1  18.616 0.001526 **
## Residuals  25656 10                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(aov.sp2)</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = tot_N_int ~ species, data = master)
## 
## $species
##            diff       lwr       upr     p adj
## SA-DS -126.1763 -191.3354 -61.01724 0.0015259</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_N_int <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> master)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_N_int by species
## t = 4.3146, df = 7.06, p-value = 0.003434
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   57.14479 195.20786
## sample estimates:
## mean in group DS mean in group SA 
##         284.0957         157.9193</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(master, plyr<span class="op">::</span>.(species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb72-2" data-line-number="2">      <span class="dt">Nint =</span> <span class="kw">mean</span>(tot_N_int, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb72-3" data-line-number="3">      <span class="dt">Nint.se =</span> <span class="kw">se</span>(tot_N_int))</a></code></pre></div>
<pre><code>##   species     Nint  Nint.se
## 1      DS 284.0957 26.52423
## 2      SA 157.9193 12.31506</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">bgp.out &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(master[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t3&quot;</span>, <span class="st">&quot;t4&quot;</span>), ], plyr<span class="op">::</span>.(species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb74-2" data-line-number="2">                 <span class="dt">bg_n_uptake         =</span> <span class="kw">mean</span>(bg_n_est), <span class="co"># mg/m2/d</span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3">                 <span class="dt">bg_n_uptake.se      =</span> <span class="kw">se</span>(bg_n_est),</a>
<a class="sourceLine" id="cb74-4" data-line-number="4">                 <span class="dt">ag_n_uptake         =</span> <span class="kw">mean</span>(n_uptake_biomass),</a>
<a class="sourceLine" id="cb74-5" data-line-number="5">                 <span class="dt">ag_n_uptake.se      =</span> <span class="kw">se</span>(n_uptake_biomass),</a>
<a class="sourceLine" id="cb74-6" data-line-number="6"></a>
<a class="sourceLine" id="cb74-7" data-line-number="7">                 <span class="dt">bg_production       =</span> <span class="kw">mean</span>(bgp_est), <span class="co"># g/m2/day</span></a>
<a class="sourceLine" id="cb74-8" data-line-number="8">                 <span class="dt">bg_production.se    =</span> <span class="kw">se</span>(bgp_est),</a>
<a class="sourceLine" id="cb74-9" data-line-number="9">                 <span class="dt">ag_production       =</span> <span class="kw">mean</span>(prodn_rate), <span class="co"># g/m2/day</span></a>
<a class="sourceLine" id="cb74-10" data-line-number="10">                 <span class="dt">ag_production.se    =</span> <span class="kw">se</span>(prodn_rate),</a>
<a class="sourceLine" id="cb74-11" data-line-number="11"></a>
<a class="sourceLine" id="cb74-12" data-line-number="12">                 <span class="dt">new_bg_biomass      =</span> <span class="kw">mean</span>(bgp_biomass_est), <span class="co"># g/m2</span></a>
<a class="sourceLine" id="cb74-13" data-line-number="13">                 <span class="dt">new_bg_biomass.se   =</span> <span class="kw">se</span>(bgp_biomass_est),</a>
<a class="sourceLine" id="cb74-14" data-line-number="14">                 <span class="dt">root_shoot_ratio    =</span> <span class="kw">mean</span>(bgp_est <span class="op">/</span><span class="st"> </span>prodn_rate),</a>
<a class="sourceLine" id="cb74-15" data-line-number="15">                 <span class="dt">root_shoot_ratio.se =</span> <span class="kw">se</span>(bgp_est <span class="op">/</span><span class="st"> </span>prodn_rate)</a>
<a class="sourceLine" id="cb74-16" data-line-number="16">)</a>
<a class="sourceLine" id="cb74-17" data-line-number="17"><span class="co"># write.csv(bgp.out, file = &quot;C:/RDATA/greenhouse/output/GRO/bgp_estimates.csv&quot;, row.names = FALSE)</span></a>
<a class="sourceLine" id="cb74-18" data-line-number="18"></a>
<a class="sourceLine" id="cb74-19" data-line-number="19"><span class="co"># stats</span></a>
<a class="sourceLine" id="cb74-20" data-line-number="20">stats<span class="op">::</span><span class="kw">t.test</span>(n_uptake_biomass <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> master[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t3&quot;</span>, <span class="st">&quot;t4&quot;</span>), ]) <span class="co"># DS higher than SA</span></a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  n_uptake_biomass by species
## t = 5.2725, df = 9.563, p-value = 0.0004192
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  39.65039 98.31965
## sample estimates:
## mean in group DS mean in group SA 
##         120.1625          51.1775</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(prodn_rate <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> master[master<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;t3&quot;</span>, <span class="st">&quot;t4&quot;</span>), ])  <span class="co"># DISP is more productive than SPAL</span></a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  prodn_rate by species
## t = 5.3314, df = 9.5908, p-value = 0.0003826
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  2.779356 6.810526
## sample estimates:
## mean in group DS mean in group SA 
##         7.813346         3.018405</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co"># Figure 6 - N uptake estimated by 2 methods --------------------------------</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="kw">ggplot</span>(master[master<span class="op">$</span>cluster <span class="op">%in%</span><span class="st"> &quot;3-4 weeks&quot;</span>, ], <span class="kw">aes</span>(<span class="dt">x =</span> n_uptake_15n, <span class="dt">y =</span> n_uptake_biomass, <span class="dt">colour =</span> species, <span class="dt">shape =</span> species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> pointSize) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">225</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># facet_wrap(~ cluster, scales = &quot;free_x&quot;) +</span></a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;N uptake (mg&quot;</span><span class="op">%.%</span>d<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">%.%</span><span class="st">&quot;m&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}<span class="op">~</span><span class="st">&quot;; primary prod.)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="st">&quot;N uptake (mg&quot;</span><span class="op">%.%</span>d<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}<span class="op">%.%</span><span class="st">&quot;m&quot;</span><span class="op">^</span>{<span class="op">-</span><span class="dv">2</span>}<span class="op">~</span><span class="st">&quot;; &quot;</span><span class="op">^</span>{<span class="dv">15</span>}<span class="op">~</span>N<span class="op">~</span><span class="st">&quot;method)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_colour_grey</span>(<span class="dt">start =</span> grayColor, <span class="dt">end =</span> <span class="fl">0.1</span>, <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">unique</span>(master<span class="op">$</span>species)[<span class="dv">1</span>], <span class="kw">unique</span>(master<span class="op">$</span>species)[<span class="dv">2</span>]), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(Distichlis)), <span class="kw">expression</span>(<span class="kw">italic</span>(Spartina)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text.align =</span> <span class="dv">0</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb78-9" data-line-number="9">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> <span class="kw">subset</span>(master, cluster <span class="op">%in%</span><span class="st"> &quot;3-4 weeks&quot;</span>), <span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">cluster =</span> <span class="st">&quot;3-4 weeks&quot;</span>, <span class="dt">n_uptake_biomass =</span> <span class="dv">50</span>, <span class="dt">n_uptake_15n =</span> <span class="dv">3</span>, <span class="dt">species =</span> <span class="st">&quot;SA&quot;</span>), <span class="dt">label =</span></a>
<a class="sourceLine" id="cb78-12" data-line-number="12">              <span class="st">&quot;paste(italic(r) ^ 2, </span><span class="ch">\&quot;</span><span class="st"> = 0.50</span><span class="ch">\&quot;</span><span class="st">)&quot;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAA/FBMVEUAAAAAADoAAGYAOpAAZpAAZrYZGRkzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOjpmOpBmkJBmkNtmtrZmtv9uTU1uTW5uTY5ubqtuq+SMjIyOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkGaQkLaQkNuQtpCQ27aQ29uQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2Zma2kDq22/+2/9u2///Ijk3I///bkDrbtmbb25Db/7bb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8Uj6FOAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATUUlEQVR4nO2dC3vbthWG6WS2nHTdJqWO03Wb08ROIift2sltzd1saVtsWpsuxv//LyPAi3gXyEOQIPC9z2NdKAokhdfAAUiADgOAgNP3DoBhA4EACQgESEAgQAICARIQCJAgCwQD7QYCARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARJ6CrRwfMb81fbjLFq4/XSTfh+95C8Sy0GXaCHQxcVFeoF7xtj69Cy90Hv6OfV+/fVN8GL5ZfoD0CE6CHRxkTEoUMM7ZIEc61PHOWPLY+cwlMUVxdPyy787T6IVxfJgRdAlWgoUFCni0fNNccds+fxGFEvB+0OhmPfFmC14Pccf+PJoRdAhWgoktAiqLG6NJ8KhIMrx30eO+B5xZYJ1AruCuAl0iA4C5WIgYQNbHMaBsnswC+o1/j6MheLQORlD8xVBl2ghUIbAhvWrWRANcZH8MimIcnjVdSjW4i+FVCJM4i/CFUGX6CiQUGV7OQ5fen6k7FdVcUztV2H8Q/FShElRDB2uCLpER4E83gsU1EVBbOzw9pcnHkTQLBphXhQ6xzF0uCLoEh0FAgMCAgESufwXZxEc+fYwBLKbdP6vTyNzFo5kgxgC2U0q/+OzS7k3kgkA60AMBEhAIECiJP+9J7LnJCGQ3aAEAiQk83/1ejKZMrZ5Nzm5j5/qJAAMRS7/N++v2erb68erKbt7ycKnOgkAU0k340+diHQM9MB1uZ1uPszZ6s08fCpIAFhHvieaq5O7HpmJUmj19j7x5C8bjUYQyG6y+R+qk2+FPV6ds4cTYU74VJwAsAtZgTbvzv1QOlsCFSTQiKPcXmQr0STZ8T2gR8qqsMzJ1NVrvw3GVMVARxmBtpe+xYunZYN1suN7QI/k819czpUJgQJ/RDUmWmHn7bbCjjIGidNw4pJW73eXjtDFdcSz96vLp/+Ox/esv/lXcM43/BR0j1z+3004U0X9QEdZgXbXxvMX/CrVRTgCY8E/iMf38IsUF4lPQffo0BN9lDfICwpBEeiEF9ELRfhfPL4nuIo+8Snonnz+L2pdT9aCQEcFAvlV1DEf3vxNeNG8G9Srwp14fA/76ywcFFZQ64JukAyiayRAJxg5uIgHMo9F2MxjIvE+Ht8j/l7N4k9BD0j3A8km0AJiRI/YEb4b3GiuiPskHBK2G98T/kWfgh7QUaDglArfD/e3p0F/kF9J/cYvl8SwwXh8DzdJ2BR+CnpAxyosRvQHAa3RIIguR/KybNAjOjTjwYDJ5n/tWgMC2U1JEN08AWAX+SC65kklCGQ3+RKo6IrEGgkAu0AQDUhAIECipB9IPpKGQHajdU800B8tz4WB4QCBAIlc/nv8olFUYUCSsn4g6a4gCGQ3aMYDEhAIkIBAgAQEAiQgECABgQCJfDO+5h23IJDd5PO/5kQFEMhuivKfdyaiJxpIUZz/1RM8SSQAbKEo/xfivm2uXEUGgewml//by/ByMskT8hDIbvKtsJqzFEAgu8HAQkACAwsBCQwsBCQwsBCQwLkwQAICARK5/F8eowoD8uSb8WO/JV+jLQaB7KaoGR/Oq9ssAWAXRQItDjGwEEiSy39X2CPfGwSB7KbgZOqYuY78ZYkQyG7QjAckIBAggX4gQCLfD3RISwDYBS7nACRwQRkgkZ9gCpe0ghogiAYkCk6m0hIAdoEgGpBAEA1I5GOgkpuPrt7MGbubTCZfzdnm3eTkviwBYBWyF9U/cHHY7ZS/fryasruXJQkAu5DM/9sXv/gl0ONP1/zN5sM8KJBqJAAMRTr/uTF+1TWZTNnq7T3bvOcujUYjCGQ3qfz3m2Cl48K4QKtvr3kp9HASCZRNAFhHrRJIcDvdlUB1EgBGIt2MTwiEGAjESHckcmN43fX48/zx6hytMBAgPblC1A/0wq+60A8EIjC5AiCBa6IBCQgESOCuzYAE7toMSOCmu7ZxcXHRZnIQyDIuLto1CHdttgzVAuGuzYajvATqPAHQLYpjoO4TAIMGAimh5X/z3vAjmX1rkDdBTcBE2g40+iGMhfesRN4KNQETGbxAcUtq/5rkTVETMJFhCyQtj1iZvDVqAkYyXH/qyCPWz7yPeqId2Xk2IZBB1LWHoQTqEs2LpQb2MAjUIfoGRo58zJz/Lnnj1ASsQVOBCPKIr5O3T03AGnQUiOROkAJ5F6gJ2INu/tDtYRDIXtqwhyXz3+NXQm8/1ZtiEwINEGLUk0kserH9OGPuGQQynVbtYYn8X3/zmbG//gUCmUy77gRJRi94CeQ//BoCmYoCe1gy/8XkiGUzJMokADRGjT0sk//b74kJAP2gdDPLJJ98A4FMQ608YgvJNxDILBS7E2wj+QYCGURL9uzrPodARtJaxbX3BB5OZRhGyzFzfYFwu6cB037MXFsg3DN1sKhpb9WKgRhu9zRIFHf1VG878x63exoaPcojNp9dgHumDoo+3Ql2ILsAQfRw6N0eVlSF4Z6pw6DXiiuxG5n3CKL1p8+YOQeC6IGhkzycfAxU84ogXQ7ECvRyR4B7ZQwGDe1hOBc2GLS0h0GgAaBb1JMGAumN3vYwCKQ1mrsjKNo7t87ZDJ0OT7fB5ySGYA8zqwTScfqLhgzEHgaBtEOrbmYJIJBODEwejkkCDT0GGpo7AqMEGiwDLHkiIFDvDNgelpze5bTeObBcAqAJQ3ZHkJid48vPVSuu3swZ27ybnNzHT5kEQF0Gbw9L5f+i6kqgh8lXc/Z4NWV3L6OnXAKgDibYw6Tz//bFL34JtPkw5yVR+FQrAbBjaF09lUiPjefGrN7es8376/DJXzgajUz4EbrEJHk4tQR6OBHmhE8FCYA9GOWOgFYCZRMAVZhnD6spEGKg5phVce2oJdDj1XnQCjtHK0weo2LmHNIHhX6gRhgtDyd1YNGQjDo90sb+Mi1guDuC3NEtuDo1xqea/fMQsMEeVjq0WX6ODuN/oUZYYg+DQO1jfNSTpqwKk56jw5LfSRK75OHkD9XjP4D8DAsW/Vb7sE4eDi4o28eRxDpmd/VUAoH2cHS0zyB75eFAoD3sEUjanYFf8F8KBKrm6KjCoBolz/CHHJVg1NBmBRyVGlSv3rJKoG4TGCANoh4IpCyBodEwZDbUHwhUD5vbW8WUzZHoOJI3XbHox4Q9BZSeypC9bY8tvyfsKab8ZKrk+VTzf1KLu5klgEDVQJ49lJ+NXzytHOpcmoBBwJ39lJ6NXxzMGiZgCLBHCjTji4E9kkCgLIh6apH7mey+4RzsqUv2l7L5rs1wpwElzfjmCQwSdPU0Jl8CWSdQL/LIXCg7CHK/mmV3be6p4Nl/oexQsDqI7q/aMlcgi+7a3GPQU3mh7LCwMojuPWQuv1B2cNgXRPduj1nkYyCj79oMd9qm7IpEE4No2KMAa86FwR41WCAQuplVkp7i7uubkjeSCegH5FFM+of1I6CwEbZwTLigDO4oJ/frusGPbsAEU7CnC0yNgVBxdYR5AiFm7hTDBII8XWOSQHCnB8wQCNVWbxggEOTpk/yvvnCcM8lRqcUJdAvc6Zd8P9DT/5ye1Rib0WvewZ7eKbigjF9TNoRbHaDi0oFBCoSYWR/ys3PwKkzne2VAHq0omZ1D/sr6bvMR7ujGkJrxsEdDBiMQ7NGTXBD9Z/G0/aRREI2oR2PyrTAe/rj6XFQPedpie+k48h3EshQMbR5LX41YmECbQJ4W8Q79kqHmqL/95DNnd1lrwwTaAva0z6IDgXyDSs9j3E0mk6/mbPNucnJfnkAr+wV7FODVnD1MgvSojPg+ByUx0O2UPz5eTdndy6IEWtkjxMyqcIv9cXexkZibhb9xZeOlWrn0+NM1f9p8mLPVm3mDBPbvDuRRRtm0B4unn+OT515oTXJZNbVyyq+6JpMpW729Z5v33KXRaNRiVsMdpbjFpxjEfCzRuc/FYX5ZNbUmmFp9e81LoYeTSKCiBBqBkkcp61c/niZa1mEeB0uWz2a7WX3cQLDUsmoKJpjyi7qq795OdyVQQQINaE0eM2bcUcDyuLw08YJ7W4gMX59+IcqO5LI9FE0w5WvolUdQt9NWY6A2Sx5D5mxqH6+iY8+Lbo7CRCegmOAnuWwPRQL5FWFx/cfrrsef549X5y21wtqtt0yZ9Kt9Sppfglxp478mlEB8W/7XSy6KvptMXlyzlvqBWo96jJk2rm2yE1+Wx0Ac/zUhBhIbc2ucy2gigJquHnPmHWybShWSLa6g5Hk1o7TC6lI7AWUNLoNmrmyZ6mkL3V2fj+gq4vGv27gfaHfHQsmdq+fBPneQ/yqoaBJxXHGHZVHP8XMRYmVX9q7LXQq0v+RBCTI40tm5iOuX9seFydRbEGhwdDHRuHTUgyBmeCgPouvEzAiDh0fh2HinxiVlJWIEGuAEl/HkBxbK92IXJyDgBQnssQFFrbAj2GMJagQ6OoI9lpDLZXHillqFIRq2hnwJFDeb5AohlDN2M5ihzUBPIBAgUVaFaTO0GehNcf6vX81oCQBbKMn/PRcA7E8AWEKZQKjCgBQl+e+iBAJSlATRaq+JBuaAZjwgAYEACQgESEAgQAICARIQCJCoN8XdvgSAdRTnv2vCfeNBFxTl//pUl3miewNXU8pSkP9erfnMjRQI1+NKk89/V35Yc3ECBgCBpMnPkVhrnnozBcKQAHky+V81G6NUAkaAQSXyZGfnqD0XvokCAXnQDwRIoCcakIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECDRKP837yYn95QEgDE0yf/Hqym7e0lIAJhDk/zffJiz1Zt58wSAOTTJ/9Xbe7Z5f+2/Go1GEMhumuT/w0kkUMMEgDnQSqCGCQBzQAwESDRrhZ2jFQYC0A8ESKAnGpCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCgC5RnVLBMER1uCoeVojWBChgpSLP/TeGwCoFAOm5rQIeFEAaQgECABAQCJCAQIAGBAIl2BYqulE5esqiIaFN3k8nkq7nSLb2eTKbilfLD2m1K/WE9xBsgHVarAj2Eu5QauqqGaFPsdqp0O0yMP1l9y8egKD+s3abUHxb/BwwOhnZYbQp0++KXoFhIDdtQQrypx5+uFW6G88B/W5Gfyg9rtyn1h8UJDoZ2WEqqsNTAMUWEm/KL36jUV0hwMF0cVriBbg4rKHdoh6VEoNTQVUVErvolvvJ/Vz6OiXVzWOGmujis1esXYgO0wxp6CSRQHDBs3p0Hm1R/WNGmBJ2Ed1qWQOpjoC4FWr0Ok1d/WPGmBMoFaiO0UyJQauiqIhK15ePP3WSq8sPabUr9Ye0qLtphtS8Q/+uoH0g0RSeTF0prFd4j4we0XRxWYlPKDyvcAvmw0BMNSEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESECguqy/vqn4dHvpOE8/F3zDdZyDmcr96gkIVBPPeVIlkHfou3KW/8b240zpbvUGBKrH9vvtpyqBOIuUQME31r8/dg4V7ldvQKC67BXIy4rCv+H5pVBaLEMwQaD1qcgyr6Ru+e8/4pfLZ7P859tLiYz1nvzTj254eFMm0Db83M0VNNE3vLHE3ka7XLir/pfWrwqW94gZAjlcgZIsSeZEYa4sZKqWXeLVJVCRjaIEGkdVW/XexrtZJhDzsjF6v5gh0B++/NxYILl/aVmBXD53zji9THzDjRZX7228m6UCSRWY3WGGQGfuOM4S8cv7D8tn3/EqZXnMc44/8if/M88PZnl1E2Xgwv+PXj77ga/G1zoTZcTBD89vEuk7B98V5nf6e2m2l+OCb+T3NplCsF9il8XuR8sOk3uhVxFkiEDL5zc5gY6f3GwvD8V7fw3fFD9r+OIzxhcLcViYz8tj/82CRzD+SuvTsf+FnTDZ9wlS32u2t8kUov0SJdDxbhn/2+1FYdnUG4YIxBbjvEBnYUk0Y//7zMLXPxxH//1CqvApWDf8gvg0IUT2fYLU95rtbW7LXDAhUGKZ/7Dbi3DHNcEUgfxIJleFzeLc4L15vCc4rCkWwTR/4+jL8XfEgyialrsqLPs+Qep7pL0NthzuVxwDcYHE1pN7VVY39oMpAvltqQqB1qcHs7BUcnnNkIgiKgVa8vKqWCDxUVOB8nu72zJLBNEQqBNElmw/fldUhT2/EYEz//W9Ay4VjyW8xFmpvEBRpRGtkX2foLFAub0NthzuV0ogviyqwjxUYSoIftHoJBU3ZHt5EAfR/FOeC8tjIRBbHMy2l75QUW652ZIkH0QflgbRTQWK9zaVQrRffJXdsiiIPkQQrYjwX9IN85gHOn96FTTjefvX9R/5ufAfg+qM5xJvGkelkCea8bNEXmab7VXN+FmpQBXN+MTeplOI9svf5dSyVDN+gWZ8J8j+oxZ3JLbQ2bL8IzWFQtCR2BHSJX32VAav20SPDBFPTayrVz8iBCr4l+at6RYuvfibbNdiLXAyFRgFBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIk/g+6kwvbIKSlMgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># ggsave(paste0(&quot;C:/RDATA/greenhouse/output/GRO/Figure6_.png&quot;), width = 80, height= 80, units = &quot;mm&quot;, dpi = 400)</span></a></code></pre></div>
<div id="documentation-of-specific-references-in-manuscript" class="section level3">
<h3>Documentation of specific references in manuscript</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">##### Documentation</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">### leaf, stem biomass differences</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">leaf &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;leaf&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;leaf &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)), ],</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">              plyr<span class="op">::</span>.(species, time, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">              <span class="dt">tot_mass =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-6" data-line-number="6">              <span class="dt">tot_n    =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-7" data-line-number="7">              <span class="dt">tot_c    =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-8" data-line-number="8">              <span class="dt">n_wa =</span> tot_n <span class="op">/</span><span class="st"> </span>tot_mass,</a>
<a class="sourceLine" id="cb80-9" data-line-number="9">              <span class="dt">c_wa =</span> tot_c <span class="op">/</span><span class="st"> </span>tot_mass</a>
<a class="sourceLine" id="cb80-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb80-11" data-line-number="11">leaf<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(leaf<span class="op">$</span>time, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb80-12" data-line-number="12"></a>
<a class="sourceLine" id="cb80-13" data-line-number="13">stem &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;belowground stems&quot;</span>, <span class="st">&quot;stems&quot;</span>), ],</a>
<a class="sourceLine" id="cb80-14" data-line-number="14">              plyr<span class="op">::</span>.(species, time, new.core.id), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb80-15" data-line-number="15">              <span class="dt">tot_mass =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-16" data-line-number="16">              <span class="dt">tot_n    =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-17" data-line-number="17">              <span class="dt">tot_c    =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb80-18" data-line-number="18">              <span class="dt">n_wa =</span> tot_n <span class="op">/</span><span class="st"> </span>tot_mass,</a>
<a class="sourceLine" id="cb80-19" data-line-number="19">              <span class="dt">c_wa =</span> tot_c <span class="op">/</span><span class="st"> </span>tot_mass</a>
<a class="sourceLine" id="cb80-20" data-line-number="20">)</a>
<a class="sourceLine" id="cb80-21" data-line-number="21">stem<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(stem<span class="op">$</span>time, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb80-22" data-line-number="22"></a>
<a class="sourceLine" id="cb80-23" data-line-number="23">leaf2 &lt;-<span class="st"> </span>leaf</a>
<a class="sourceLine" id="cb80-24" data-line-number="24"><span class="kw">names</span>(leaf2)[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">names</span>(leaf)[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>], <span class="st">&quot;.leaf&quot;</span>)</a>
<a class="sourceLine" id="cb80-25" data-line-number="25">leaf2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(leaf2, stem[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>])</a>
<a class="sourceLine" id="cb80-26" data-line-number="26">leaf2<span class="op">$</span>n_wa_ag &lt;-<span class="st"> </span>(leaf2<span class="op">$</span>tot_n.leaf <span class="op">+</span><span class="st"> </span>leaf2<span class="op">$</span>tot_n) <span class="op">/</span><span class="st"> </span>(leaf2<span class="op">$</span>tot_mass.leaf <span class="op">+</span><span class="st"> </span>leaf2<span class="op">$</span>tot_mass)</a>
<a class="sourceLine" id="cb80-27" data-line-number="27"></a>
<a class="sourceLine" id="cb80-28" data-line-number="28">plyr<span class="op">::</span><span class="kw">ddply</span>(leaf[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a></code></pre></div>
<pre><code>##   species tot_mass    tot_n    tot_c       n_wa      c_wa t
## 1      DS 107.6664 2.511001 38.52983 0.02338249 0.3596999 2
## 2      SA 119.9773 2.044879 41.32419 0.01756821 0.3468066 2</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(leaf[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a></code></pre></div>
<pre><code>##   species tot_mass     tot_n    tot_c         n_wa        c_wa         t
## 1      DS 10.65637 0.2430274 3.725933 0.0003558103 0.003001113 0.3779645
## 2      SA 12.07115 0.1802621 3.903063 0.0007436392 0.003292679 0.3779645</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                      Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)           36322  1 23.4199 5.135e-05 ***
## t                      3775  1  2.4341  0.130814    
## as.factor(species)    12921  1  8.3314  0.007740 ** 
## t:as.factor(species)  13312  1  8.5835  0.006975 ** 
## Residuals             40323 26                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = tot_mass ~ as.factor(species), data = leaf)
## 
## $`as.factor(species)`
##           diff       lwr      upr     p adj
## SA-DS 12.31093 -20.67229 45.29415 0.4509269</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(tot_mass <span class="op">~</span><span class="st"> </span>t, <span class="dt">data =</span> leaf[leaf<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>,]))</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = tot_mass ~ t, data = leaf[leaf$species %in% 
##     &quot;SA&quot;, ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -83.195 -25.024  -0.242  26.943  51.767 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  157.123     17.651   8.902 6.82e-07 ***
## t            -18.573      7.206  -2.577    0.023 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 39.47 on 13 degrees of freedom
## Multiple R-squared:  0.3382, Adjusted R-squared:  0.2873 
## F-statistic: 6.643 on 1 and 13 DF,  p-value: 0.02297</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="co"># N content</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: n_wa
##                          Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          0.00268555  1 551.4793 &lt; 2.2e-16 ***
## t                    0.00000032  1   0.0659    0.7994    
## as.factor(species)   0.00012454  1  25.5745  2.89e-05 ***
## t:as.factor(species) 0.00000580  1   1.1913    0.2851    
## Residuals            0.00012661 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = n_wa ~ as.factor(species), data = leaf)
## 
## $`as.factor(species)`
##               diff          lwr          upr p adj
## SA-DS -0.005814279 -0.007502942 -0.004125616 1e-07</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(stem[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a></code></pre></div>
<pre><code>##   species  tot_mass     tot_n    tot_c       n_wa      c_wa t
## 1      DS 226.92637 2.4616794 82.14610 0.01089131 0.3617906 2
## 2      SA  82.53025 0.9258934 26.73752 0.01189569 0.3233946 2</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(stem[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a></code></pre></div>
<pre><code>##   species  tot_mass      tot_n    tot_c         n_wa        c_wa         t
## 1      DS 15.579734 0.16393653 5.785063 0.0002945114 0.003952412 0.3779645
## 2      SA  9.609516 0.08861614 3.134505 0.0006939962 0.004725146 0.3779645</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                      Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          236865  1 103.6830 1.453e-10 ***
## t                       645  1   0.2823   0.59971    
## as.factor(species)    24022  1  10.5150   0.00324 ** 
## t:as.factor(species)   8064  1   3.5298   0.07153 .  
## Residuals             59397 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = tot_mass ~ as.factor(species), data = stem)
## 
## $`as.factor(species)`
##            diff       lwr       upr p adj
## SA-DS -144.3961 -181.8921 -106.9001     0</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="co"># N content: no diffs</span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: n_wa
##                          Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          0.00054896  1 161.1634 1.191e-12 ***
## t                    0.00000128  1   0.3759    0.5451    
## as.factor(species)   0.00000080  1   0.2353    0.6317    
## t:as.factor(species) 0.00000925  1   2.7158    0.1114    
## Residuals            0.00008856 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = n_wa ~ as.factor(species), data = stem)
## 
## $`as.factor(species)`
##              diff           lwr         upr     p adj
## SA-DS 0.001004376 -0.0005399213 0.002548674 0.1935244</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_n <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_n
##                       Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          26.0830  1 104.5276 1.334e-10 ***
## t                     0.2368  1   0.9490  0.338945    
## as.factor(species)    2.9313  1  11.7474  0.002039 ** 
## t:as.factor(species)  0.7694  1   3.0832  0.090880 .  
## Residuals             6.4878 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(tot_n <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> stem))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = tot_n ~ as.factor(species), data = stem)
## 
## $`as.factor(species)`
##            diff       lwr       upr p adj
## SA-DS -1.535786 -1.917516 -1.154056     0</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="co"># mean N content for all</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2">plyr<span class="op">::</span><span class="kw">ddply</span>(stem[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a></code></pre></div>
<pre><code>##    .id tot_mass    tot_n    tot_c      n_wa      c_wa t
## 1 &lt;NA&gt; 154.7283 1.693786 54.44181 0.0113935 0.3425926 2</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(stem[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a></code></pre></div>
<pre><code>##    .id tot_mass     tot_n    tot_c         n_wa        c_wa         t
## 1 &lt;NA&gt; 16.14381 0.1694571 6.075877 0.0003819535 0.004676438 0.2626129</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">### aboveground weighted average N content</a>
<a class="sourceLine" id="cb114-2" data-line-number="2">car<span class="op">::</span><span class="kw">Anova</span>(stats<span class="op">::</span><span class="kw">aov</span>(n_wa_ag <span class="op">~</span><span class="st"> </span>t<span class="op">*</span>species, <span class="dt">data =</span> leaf2), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>) <span class="co"># no diffs by spp</span></a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: n_wa_ag
##                 Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept) 0.00099618  1 259.8711 4.719e-15 ***
## t           0.00000389  1   1.0157    0.3228    
## species     0.00000146  1   0.3807    0.5426    
## t:species   0.00000498  1   1.2985    0.2649    
## Residuals   0.00009967 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(leaf2, plyr<span class="op">::</span>.(species, time), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb116-2" data-line-number="2">      <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_wa_ag),</a>
<a class="sourceLine" id="cb116-3" data-line-number="3">      <span class="dt">n_pct.se =</span> <span class="kw">se</span>(n_wa_ag))</a></code></pre></div>
<pre><code>##    species time      n_pct     n_pct.se
## 1       DS   t0 0.01469126 6.094328e-04
## 2       DS   t1 0.01428972 8.674996e-05
## 3       DS   t2 0.01401531 4.702156e-04
## 4       DS   t3 0.01508891 1.223338e-03
## 5       DS   t4 0.01609295 8.631092e-04
## 6       SA   t0 0.01345688 8.689407e-04
## 7       SA   t1 0.01602470 1.275789e-03
## 8       SA   t2 0.01232054 5.100072e-04
## 9       SA   t3 0.01633146 2.067790e-03
## 10      SA   t4 0.01798511 2.076930e-04</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(leaf2, plyr<span class="op">::</span>.(species), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb118-2" data-line-number="2">      <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_wa_ag),</a>
<a class="sourceLine" id="cb118-3" data-line-number="3">      <span class="dt">n_pct.se =</span> <span class="kw">se</span>(n_wa_ag))</a></code></pre></div>
<pre><code>##   species      n_pct     n_pct.se
## 1      DS 0.01483563 0.0003447541
## 2      SA 0.01522374 0.0007067786</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(leaf2, plyr<span class="op">::</span>.(), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb120-2" data-line-number="2">      <span class="dt">n_pct =</span> <span class="kw">mean</span>(n_wa_ag),</a>
<a class="sourceLine" id="cb120-3" data-line-number="3">      <span class="dt">n_pct.se =</span> <span class="kw">se</span>(n_wa_ag))</a></code></pre></div>
<pre><code>##    .id      n_pct     n_pct.se
## 1 &lt;NA&gt; 0.01502968 0.0003880276</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">### belowground biomass and tissue N</a>
<a class="sourceLine" id="cb122-2" data-line-number="2">rts &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ddply</span>(CN_mass_data[CN_mass_data<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fine roots&quot;</span>, <span class="st">&quot;coarse roots&quot;</span>, <span class="st">&quot;rhizomes&quot;</span>), ],</a>
<a class="sourceLine" id="cb122-3" data-line-number="3">             plyr<span class="op">::</span>.(species, time, new.core.id, sample.type), plyr<span class="op">::</span>summarise,</a>
<a class="sourceLine" id="cb122-4" data-line-number="4">             <span class="dt">tot_mass =</span> <span class="kw">sum</span>(g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb122-5" data-line-number="5">             <span class="dt">tot_n    =</span> <span class="kw">sum</span>(n_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb122-6" data-line-number="6">             <span class="dt">tot_c    =</span> <span class="kw">sum</span>(c_pct <span class="op">*</span><span class="st"> </span>g_core <span class="op">/</span><span class="st"> </span>pot.m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb122-7" data-line-number="7">             <span class="dt">n_wa =</span> tot_n <span class="op">/</span><span class="st"> </span>tot_mass,</a>
<a class="sourceLine" id="cb122-8" data-line-number="8">             <span class="dt">c_wa =</span> tot_c <span class="op">/</span><span class="st"> </span>tot_mass</a>
<a class="sourceLine" id="cb122-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb122-10" data-line-number="10">rts<span class="op">$</span>t &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(rts<span class="op">$</span>time, <span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb122-11" data-line-number="11"></a>
<a class="sourceLine" id="cb122-12" data-line-number="12">plyr<span class="op">::</span><span class="kw">ddply</span>(rts[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species, sample.type), plyr<span class="op">::</span><span class="kw">numcolwise</span>(mean))</a></code></pre></div>
<pre><code>##   species  sample.type tot_mass     tot_n     tot_c        n_wa      c_wa
## 1      DS coarse roots 126.3012 1.1332728  42.43768 0.009226600 0.3306609
## 2      DS   fine roots  75.3850 0.7342576  25.79367 0.009824598 0.3427565
## 3      DS     rhizomes 913.1224 7.7302660 315.06807 0.008506937 0.3455798
## 4      SA coarse roots 167.8539 1.1071499  56.32012 0.006765286 0.3327626
## 5      SA   fine roots 204.6743 1.6601123  68.49040 0.008075992 0.3358803
## 6      SA     rhizomes 408.3834 2.5881742 149.23494 0.006491778 0.4175223
##   t
## 1 2
## 2 2
## 3 2
## 4 2
## 5 2
## 6 2</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1">plyr<span class="op">::</span><span class="kw">ddply</span>(rts[, <span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)], plyr<span class="op">::</span>.(species, sample.type), plyr<span class="op">::</span><span class="kw">numcolwise</span>(se))</a></code></pre></div>
<pre><code>##   species  sample.type  tot_mass      tot_n     tot_c         n_wa
## 1      DS coarse roots 16.069385 0.11858671  5.971942 0.0002962368
## 2      DS   fine roots  4.297981 0.03610325  1.483698 0.0001715868
## 3      DS     rhizomes 48.371193 0.43830526 17.120696 0.0002785127
## 4      SA coarse roots 17.328046 0.10402130  6.126823 0.0002674477
## 5      SA   fine roots 27.086418 0.25094108  8.646632 0.0002646021
## 6      SA     rhizomes 38.562426 0.22276169 13.753005 0.0002614945
##          c_wa         t
## 1 0.006394668 0.3779645
## 2 0.005593908 0.3779645
## 3 0.005838105 0.3779645
## 4 0.004444362 0.3779645
## 5 0.004792412 0.3779645
## 6 0.085079811 0.3779645</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;coarse roots&quot;</span>, ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                      Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)           65337  1 14.8194 0.0006912 ***
## t                      1078  1  0.2445 0.6251205    
## as.factor(species)    11570  1  2.6242 0.1173136    
## t:as.factor(species)   2629  1  0.5962 0.4469877    
## Residuals            114630 26                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>, ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                      Sum Sq Df F value    Pr(&gt;F)    
## (Intercept)           37758  1 10.4255  0.003354 ** 
## t                       994  1  0.2746  0.604721    
## as.factor(species)   109491  1 30.2323 9.065e-06 ***
## t:as.factor(species)  23992  1  6.6246  0.016109 *  
## Residuals             94163 26                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                       Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          4755956  1 163.1870 1.035e-12 ***
## t                      28986  1   0.9946    0.3278    
## as.factor(species)    674542  1  23.1450 5.536e-05 ***
## t:as.factor(species)     810  1   0.0278    0.8689    
## Residuals             757749 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(tot_mass <span class="op">~</span><span class="st"> </span>t, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(rts<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>), ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = tot_mass ~ t, data = rts[(rts$sample.type %in% 
##     &quot;fine roots&quot;) &amp; (rts$species %in% &quot;SA&quot;), ])
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -87.36 -45.90 -31.56  22.21 242.24 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   296.18      37.47   7.904 2.55e-06 ***
## t             -45.75      15.30  -2.991   0.0104 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 83.79 on 13 degrees of freedom
## Multiple R-squared:  0.4076, Adjusted R-squared:  0.362 
## F-statistic: 8.943 on 1 and 13 DF,  p-value: 0.01043</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(tot_mass <span class="op">~</span><span class="st"> </span>t, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(rts<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;DS&quot;</span>), ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = tot_mass ~ t, data = rts[(rts$sample.type %in% 
##     &quot;fine roots&quot;) &amp; (rts$species %in% &quot;DS&quot;), ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -20.9157 -10.0738  -0.9636  12.9433  20.8067 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   86.900      6.662  13.044 7.64e-09 ***
## t             -5.757      2.720  -2.117   0.0541 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 14.9 on 13 degrees of freedom
## Multiple R-squared:  0.2563, Adjusted R-squared:  0.1991 
## F-statistic: 4.481 on 1 and 13 DF,  p-value: 0.05413</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ]), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: tot_mass
##                       Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          4755956  1 163.1870 1.035e-12 ***
## t                      28986  1   0.9946    0.3278    
## as.factor(species)    674542  1  23.1450 5.536e-05 ***
## t:as.factor(species)     810  1   0.0278    0.8689    
## Residuals             757749 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(tot_mass <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ]))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = tot_mass ~ as.factor(species), data = rts[rts$sample.type %in% &quot;rhizomes&quot;, ])
## 
## $`as.factor(species)`
##           diff       lwr       upr p adj
## SA-DS -504.739 -631.4564 -378.0217     0</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_mass <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by as.factor(species)
## t = 8.1592, df = 26.676, p-value = 1.006e-08
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  377.7376 631.7404
## sample estimates:
## mean in group DS mean in group SA 
##         913.1224         408.3834</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="kw">summary</span>(stats<span class="op">::</span><span class="kw">lm</span>(tot_mass <span class="op">~</span><span class="st"> </span>t, <span class="dt">data =</span> rts[(rts<span class="op">$</span>species <span class="op">%in%</span><span class="st"> &quot;SA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>),]))</a></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = tot_mass ~ t, data = rts[(rts$species %in% 
##     &quot;SA&quot;) &amp; (rts$sample.type %in% &quot;rhizomes&quot;), ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -267.01  -80.80  -14.13  111.83  311.86 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   455.85      67.41   6.762 1.34e-05 ***
## t             -23.73      27.52  -0.862    0.404    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 150.7 on 13 degrees of freedom
## Multiple R-squared:  0.05411,    Adjusted R-squared:  -0.01865 
## F-statistic: 0.7437 on 1 and 13 DF,  p-value: 0.4041</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(n_wa <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  n_wa by as.factor(species)
## t = 5.2748, df = 27.889, p-value = 1.324e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.001232461 0.002797856
## sample estimates:
## mean in group DS mean in group SA 
##      0.008506937      0.006491778</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_n <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> rts[rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>, ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_n by as.factor(species)
## t = 10.459, df = 20.78, p-value = 9.84e-10
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  4.118960 6.165224
## sample estimates:
## mean in group DS mean in group SA 
##         7.730266         2.588174</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(rts<span class="op">$</span>time))) {</a>
<a class="sourceLine" id="cb148-2" data-line-number="2">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb148-3" data-line-number="3">  <span class="kw">print</span>(stats<span class="op">::</span><span class="kw">t.test</span>(n_wa <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">unique</span>(rts<span class="op">$</span>time)[i])) <span class="op">&amp;</span><span class="st"> </span>(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;coarse roots&quot;</span>), ]))</a>
<a class="sourceLine" id="cb148-4" data-line-number="4">}</a></code></pre></div>
<pre><code>## [1] 1
## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 4.9997, df = 3.9998, p-value = 0.007493
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.001418944 0.004963033
## sample estimates:
## mean in group DS mean in group SA 
##      0.009716178      0.006525189 
## 
## [1] 2
## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 1.5256, df = 2.7603, p-value = 0.2322
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.001066074  0.002854235
## sample estimates:
## mean in group DS mean in group SA 
##      0.007830078      0.006935998 
## 
## [1] 3
## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 3.4292, df = 2.93, p-value = 0.04309
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.0001524227 0.0049894689
## sample estimates:
## mean in group DS mean in group SA 
##      0.009277539      0.006706593 
## 
## [1] 4
## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 3.4923, df = 2.478, p-value = 0.0533
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.000109687  0.007394101
## sample estimates:
## mean in group DS mean in group SA 
##      0.009586145      0.005943938 
## 
## [1] 5
## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 1.9533, df = 2.4345, p-value = 0.1668
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.001738741  0.005755435
## sample estimates:
## mean in group DS mean in group SA 
##      0.009723060      0.007714713</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(n_wa <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;coarse roots&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 6.1671, df = 27.712, p-value = 1.221e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.001643403 0.003279225
## sample estimates:
## mean in group DS mean in group SA 
##      0.009226600      0.006765286</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_mass <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = -4.7142, df = 14.705, p-value = 0.0002917
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -187.84742  -70.73123
## sample estimates:
## mean in group DS mean in group SA 
##          75.3850         204.6743</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(n_wa <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 5.5447, df = 24.005, p-value = 1.053e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.001097728 0.002399484
## sample estimates:
## mean in group DS mean in group SA 
##      0.009824598      0.008075992</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_n <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;fine roots&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_n by species
## t = -3.6519, df = 14.579, p-value = 0.002461
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.467591 -0.384118
## sample estimates:
## mean in group DS mean in group SA 
##        0.7342576        1.6601123</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="co"># rhizome biomass</span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(rts<span class="op">$</span>time))) {</a>
<a class="sourceLine" id="cb158-3" data-line-number="3">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb158-4" data-line-number="4">  <span class="kw">print</span>(stats<span class="op">::</span><span class="kw">t.test</span>(tot_mass <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>time <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">unique</span>(rts<span class="op">$</span>time)[i])) <span class="op">&amp;</span><span class="st"> </span>(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>), ]))</a>
<a class="sourceLine" id="cb158-5" data-line-number="5">}</a></code></pre></div>
<pre><code>## [1] 1
## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = 3.4618, df = 2.8079, p-value = 0.04495
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   19.58183 869.01860
## sample estimates:
## mean in group DS mean in group SA 
##        1017.4263         573.1261 
## 
## [1] 2
## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = 3.7772, df = 2.7101, p-value = 0.0387
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##    71.16302 1296.06178
## sample estimates:
## mean in group DS mean in group SA 
##         990.6909         307.0785 
## 
## [1] 3
## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = 3.5023, df = 3.9986, p-value = 0.02486
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   72.30636 625.80955
## sample estimates:
## mean in group DS mean in group SA 
##         690.7518         341.6939 
## 
## [1] 4
## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = 6.8245, df = 3.4792, p-value = 0.003944
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  337.7992 851.6722
## sample estimates:
## mean in group DS mean in group SA 
##        1018.7826         424.0469 
## 
## [1] 5
## 
##  Welch Two Sample t-test
## 
## data:  tot_mass by species
## t = 6.2793, df = 3.8612, p-value = 0.003694
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  249.2724 654.7053
## sample estimates:
## mean in group DS mean in group SA 
##         847.9606         395.9718</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(n_wa <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  n_wa by species
## t = 5.2748, df = 27.889, p-value = 1.324e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.001232461 0.002797856
## sample estimates:
## mean in group DS mean in group SA 
##      0.008506937      0.006491778</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(tot_n <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> rts[(rts<span class="op">$</span>sample.type <span class="op">%in%</span><span class="st"> &quot;rhizomes&quot;</span>), ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  tot_n by species
## t = 10.459, df = 20.78, p-value = 9.84e-10
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  4.118960 6.165224
## sample estimates:
## mean in group DS mean in group SA 
##         7.730266         2.588174</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="co"># N content</span></a>
<a class="sourceLine" id="cb164-2" data-line-number="2">car<span class="op">::</span><span class="kw">Anova</span>(aov1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf), <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</a></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: n_wa
##                          Sum Sq Df  F value    Pr(&gt;F)    
## (Intercept)          0.00268555  1 551.4793 &lt; 2.2e-16 ***
## t                    0.00000032  1   0.0659    0.7994    
## as.factor(species)   0.00012454  1  25.5745  2.89e-05 ***
## t:as.factor(species) 0.00000580  1   1.1913    0.2851    
## Residuals            0.00012661 26                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1">stats<span class="op">::</span><span class="kw">TukeyHSD</span>(stats<span class="op">::</span><span class="kw">aov</span>(n_wa <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(species), <span class="dt">data =</span> leaf))</a></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: stats::aov(formula = n_wa ~ as.factor(species), data = leaf)
## 
## $`as.factor(species)`
##               diff          lwr          upr p adj
## SA-DS -0.005814279 -0.007502942 -0.004125616 1e-07</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1">stats<span class="op">::</span><span class="kw">t.test</span>(recovery2 <span class="op">~</span><span class="st"> </span>species, <span class="dt">data =</span> mat2[mat2<span class="op">$</span>time <span class="op">%in%</span><span class="st"> &quot;t4&quot;</span>, ])</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  recovery2 by species
## t = 1.7345, df = 2.364, p-value = 0.2053
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2297901  0.6300323
## sample estimates:
## mean in group DS mean in group SA 
##        0.7026951        0.5025740</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="kw">summary</span>(mat2<span class="op">$</span>recovery2[mat2<span class="op">$</span>recovery2 <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>])</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.3373  0.4437  0.5207  0.5447  0.6607  0.8683</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
